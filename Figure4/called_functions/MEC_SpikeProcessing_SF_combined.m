%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%Inh/Exc cell clusdtering AND Theta phase locking plotting for MEC units

%This script has clustering/plotting code - uses files generated by
%TSprocessSpikes and finds which clusters belong to which brain regions
%Clusters into inh vs. exc neurons  and will plot phase locking info for different
%subregions/cell types 
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%animals = {'TS112-0' 'TS114-0' 'TS114-1'  'TS111-1' 'TS111-2' 'TS115-2' 'TS116-3' ...
%     'TS116-0' 'TS116-2' 'TS117-0' 'TS118-4'  'TS118-0' 'TS118-3' 'TS88-3' 'TS90-0' ...
%     'TS89-1' 'TS110-0' 'TS114-3' 'TS113-1' 'TS117-4' 'TS118-2' 'TS86-1' 'TS89-3' ...
%     'TS91-1' 'TS110-3' 'TS112-1' 'TS114-2' 'TS113-3' 'TS113-2' 'TS115-1' 'TS116-1' ...
%     'TS117-1' 'TS86-2' 'TS89-2' 'TS91-2' 'TS90-2'}; %list of all animals for susie summer ephys experiment

animals = { 'TS112-0' 'TS114-0' 'TS114-1'  'TS111-1' 'TS111-2' 'TS115-2' 'TS116-3' ...
    'TS116-0' 'TS116-2' 'TS117-0' 'TS118-4'  'TS118-0' 'TS118-3' 'TS88-3' 'TS90-0' ...
    'TS89-1' 'TS114-3' 'TS113-1' 'TS118-2' 'TS86-1' 'TS89-3' ...
    'TS91-1' 'TS110-3' 'TS114-2' 'TS115-1' 'TS116-1' ...
    'TS117-1' 'TS86-2' 'TS89-2' 'TS91-2' 'TS90-2'}; %list of all animals for susie summer ephys experiment
%112-1 taken out since no master MEC; 113-2 out no master MEC
%110-0 117-4 113-3 seizures for control, taking out

track= 1;
asym=[];
c=[];
c2=[];
meanAC=[];
burst=[];
burstbw = [];
mAmp = [];
mISI=[];
r2CA1=[];
pval2CA1=[];
pval2MEC=[];
mu2CA1=[];
r2MEC=[];
mu2MEC=[];
mFR=[];
FRmean = [];
highestFR = [];
CSI = [];
animal_ind = {};
group_ind = {};


%cell regions
M1=[]; %MEC1
M2=[];
M3=[];

uind=0;  %master unit index

for anim=1:length(animals)  %loop through all animals and get info about each cluster
    animal=animals{anim};
    [CA1DGshank, CA3shank, MECshank, LECshank]=getCA1DGCA3ECshankFULL_SF(animal);
    for shank=[MECshank]  %for now I only have 1 shank for each animal, I will edit getshank function if later want to add more single units data from more shanks

        [ch]=getchannels(animal,shank);  % get channels
        group = ch.group;
        %load info about units generated by TSprocessSpikes_Lruntime_SF
        load(['Y:\Susie\2020\Summer_Ephys_ALL\kilosort\' animal '\shank' num2str(shank) '_processedunits_run_track' num2str(track) '.mat']); %units
        load(['Y:\Susie\2020\Summer_Ephys_ALL\kilosort\' animal '\shank' num2str(shank) '_processedunitswholetrack.mat']); %unitswholetrack, use this for cell type classification

        % below is onlyMEC unit version
%         if ~isempty(ch.MEC12) && ~isempty (ch.MEC11) %find units in MEC1
%             M1units=find(units.correctclusterch>=ch.MEC12 & units.correctclusterch<ch.MEC11); 
%             M1=[M1 M1units+uind];
%         end
%     
%         if ~isempty(ch.MEC22) && ~isempty (ch.MEC21) %find units in MEC2
%             M2units=find(units.correctclusterch>=ch.MEC22 & units.correctclusterch<ch.MEC21); 
%             M2=[M2 M2units+uind];
%         end
%         
%         if ~isempty(ch.MEC32) && ~isempty (ch.MEC31) %find units in MEC3
%             M3units=find(units.correctclusterch>=ch.MEC32 & units.correctclusterch<ch.MEC31); 
%             M3=[M3 M3units+uind];
%         end

        %include LEC version
        if ~isempty(ch.EC12) && ~isempty (ch.EC11) %find units in MEC1
            M1units=find(units.correctclusterch>=ch.EC12 & units.correctclusterch<ch.EC11); 
            M1=[M1 M1units+uind];
        end
    
        if ~isempty(ch.EC22) && ~isempty (ch.EC21) %find units in MEC2
            M2units=find(units.correctclusterch>=ch.EC22 & units.correctclusterch<ch.EC21); 
            M2=[M2 M2units+uind];
        end
        
        if ~isempty(ch.EC32) && ~isempty (ch.EC31) %find units in MEC3
            M3units=find(units.correctclusterch>=ch.EC32 & units.correctclusterch<ch.EC31); 
            M3=[M3 M3units+uind];
        end
                 
        %put spike attributes into master array
        for u=1:length(units.waveforms)  %getting all the important info about each unit from file we loaded in earlier 
            uind=uind+1;
            animal_ind{uind} = animal;  %added this so I can know which animal each cluster belongs to for plotting later
            group_ind{uind} = group;

            if ~isempty(units.spikes{u}) 
                numspikes(uind)=units.numspikes(u);
                refravio(uind)=units.refravio(u);

                r2CA1(uind)=units.CA1thetaPL{u}.r;
                mu2CA1(uind)=units.CA1thetaPL{u}.mu;
                pval2CA1(uind) = units.CA1thetaPL{u}.pval;
                r2MEC(uind)=units.MECIIthetaPL{u}.r;
                mu2MEC(uind)=units.MECIIthetaPL{u}.mu;
                pval2MEC(uind) = units.MECIIthetaPL{u}.pval;
                r2DG(uind)=units.DGthetaPL{u}.r; 
                mu2DG(uind)=units.DGthetaPL{u}.mu;
                pval2DG(uind) = units.DGthetaPL{u}.pval;

                burst(uind)=units.burst(u);
                burstbw(uind) = units.burstbw(u);
                mISI(uind)=units.mISI(u);
                mAmp(uind)=units.mAmp(u);

                c(uind)=unitswholetrack.wavesc(u);
                asym(uind)=unitswholetrack.wavesasym(u); 
                FRmean(uind)=unitswholetrack.FRmean(u); %method 1: calculate the total time that each cluster show decent firing above meanFR. then devided by this time
                meanAC(uind)=unitswholetrack.meanAC(u);
                CSI(uind)=unitswholetrack.CSI(u);

            elseif isempty(units.spikes{u})
                disp(['empty cluster' num2str(u) 'in animal ' animal])
            end
        end
    end %end each shank
end %end each animal


% to identify the unqualified units
unqualifylist = [];
for u=1:length(c)
    if numspikes(u) < 200 || refravio(u) > 0.6 || c(u) < 0.1
        unqualifylist = [u unqualifylist];
    end
end
%to take out from M1 M2 M3 unit list
M1_qua_ind=~ismember(M1,unqualifylist);  %set unqualified as 0, qualified as 1
M2_qua_ind=~ismember(M2,unqualifylist);  %set unqualified as 0, qualified as 1
M3_qua_ind=~ismember(M3,unqualifylist);  %set unqualified as 0, qualified as 1
M1 = M1(M1_qua_ind(:) == 1);
M2 = M2(M2_qua_ind(:) == 1);
M3 = M3(M3_qua_ind(:) == 1);


%%
% CLUSTER!
% **********use this for EC***********

%below is hardset rule base on previous kmean explring
x=[ c' ]; %options: %meanAC' asym2' meanAC'  mISI' c2' mFR'  %only c works best for MEC   
exc = find(x>=0.4);
inh = find(x<0.4);
% 
% % % below is kmean, comment out now bc it generate different result each run
% x=[ c' ]; %options: %meanAC' asym2' meanAC'  mISI' c2' mFR'  %only c works best for MEC   
% [idx,C] = kmeans(x,2); %sort into two clusters and return cluster centroid locations?
% [M, I]=max(C(:,1)); %finds indices of max value and puts them in output vector I
% exc=find(idx==I);  %getting excitatory and inhibitory cells
% inh=find(idx~=I);
% 
% 
%  figure(2);clf; scatter3(FRmean(exc),c(exc),asym(exc),20, 'g');
%  hold on; scatter3(FRmean(inh),c(inh),asym(inh),20,'r');
%  xlabel('Firing Rate')
%  ylabel('c')
%  zlabel('Asym')
%  title('All MEC Cells');
%  
%  
 %%
genotype_ind = zeros(length(group_ind), 1);  %make logical index for genotype
for i=1:length(genotype_ind)
    if group_ind{i} == '3wc'
       genotype_ind(i) = 1;
    elseif group_ind{i} == '3wp'
        genotype_ind(i) = 2;
    elseif group_ind{i} == '8wc'
        genotype_ind(i) = 3;
    elseif group_ind{i} == '8wp'
        genotype_ind(i) = 4;
    end
end

g_3wccells = find(genotype_ind == 1);  %find indices of all 3wc cells
g_3wpcells=find(genotype_ind == 2);     %find indices of all 3wp cells 
g_8wccells=find(genotype_ind == 3);     %find indices of all 8wc cells 
g_8wpcells=find(genotype_ind == 4);     %find indices of all 8wp cells 

eM1=intersect(exc,M1);  
iM1=intersect(inh,M1); 
eM2=intersect(exc,M2);  
iM2=intersect(inh,M2); 
eM3=intersect(exc,M3); 
iM3=intersect(inh,M3); 

eM1_3wc = intersect(g_3wccells, eM1);
eM1_3wp = intersect(g_3wpcells, eM1);
eM1_8wc = intersect(g_8wccells, eM1);
eM1_8wp = intersect(g_8wpcells, eM1);

iM1_3wc = intersect(g_3wccells, iM1);
iM1_3wp = intersect(g_3wpcells, iM1);
iM1_8wc = intersect(g_8wccells, iM1);
iM1_8wp = intersect(g_8wpcells, iM1);


eM2_3wc = intersect(g_3wccells, eM2);
eM2_3wp = intersect(g_3wpcells, eM2);
eM2_8wc = intersect(g_8wccells, eM2);
eM2_8wp = intersect(g_8wpcells, eM2);

iM2_3wc = intersect(g_3wccells, iM2);
iM2_3wp = intersect(g_3wpcells, iM2);
iM2_8wc = intersect(g_8wccells, iM2);
iM2_8wp = intersect(g_8wpcells, iM2);


eM3_3wc = intersect(g_3wccells, eM3);
eM3_3wp = intersect(g_3wpcells, eM3);
eM3_8wc = intersect(g_8wccells, eM3); 
eM3_8wp = intersect(g_8wpcells, eM3);

iM3_3wc = intersect(g_3wccells, iM3);
iM3_3wp = intersect(g_3wpcells, iM3);
iM3_8wc = intersect(g_8wccells, iM3);
iM3_8wp = intersect(g_8wpcells, iM3);

%%%%%%%%%%%%%%%%

%below is all exc/inh/weird cells for each group

e3wc = intersect(g_3wccells, exc);
e3wp = intersect(g_3wpcells, exc);
e8wc = intersect(g_8wccells, exc);
e8wp = intersect(g_8wpcells, exc);

i3wc = intersect(g_3wccells, inh);
i3wp = intersect(g_3wpcells, inh);
i8wc = intersect(g_8wccells, inh);
i8wp = intersect(g_8wpcells, inh);

%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%Grabbing values for each group
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% r values by genotype
%below is MEC cells PL to CA1 theta
e_M1r2CA1_3wc = r2CA1(eM1_3wc);% phase lock r value of MECI exc cells to CA1 theta
e_M1r2CA1_3wp = r2CA1(eM1_3wp);
e_M1r2CA1_8wc = r2CA1(eM1_8wc);
e_M1r2CA1_8wp = r2CA1(eM1_8wp);

i_M1r2CA1_3wc = r2CA1(iM1_3wc);% phase lock r value of MECI inh cells to CA1 theta
i_M1r2CA1_3wp = r2CA1(iM1_3wp);
i_M1r2CA1_8wc = r2CA1(iM1_8wc);
i_M1r2CA1_8wp = r2CA1(iM1_8wp);

e_M2r2CA1_3wc = r2CA1(eM2_3wc);% phase lock r value of MECII exc cells to CA1 theta
e_M2r2CA1_3wp = r2CA1(eM2_3wp);
e_M2r2CA1_8wc = r2CA1(eM2_8wc);
e_M2r2CA1_8wp = r2CA1(eM2_8wp);

i_M2r2CA1_3wc = r2CA1(iM2_3wc);% phase lock r value of MECII inh cells to CA1 theta
i_M2r2CA1_3wp = r2CA1(iM2_3wp);
i_M2r2CA1_8wc = r2CA1(iM2_8wc);
i_M2r2CA1_8wp = r2CA1(iM2_8wp);

e_M3r2CA1_3wc = r2CA1(eM3_3wc);% phase lock r value of MECIII exc cells to CA1 theta
e_M3r2CA1_3wp = r2CA1(eM3_3wp);
e_M3r2CA1_8wc = r2CA1(eM3_8wc);
e_M3r2CA1_8wp = r2CA1(eM3_8wp);

i_M3r2CA1_3wc = r2CA1(iM3_3wc);% phase lock r value of MECIII inh cells to CA1 theta
i_M3r2CA1_3wp = r2CA1(iM3_3wp);
i_M3r2CA1_8wc = r2CA1(iM3_8wc);
i_M3r2CA1_8wp = r2CA1(iM3_8wp);


%below is MEC cells PL to MECII theta

e_M1r2MEC_3wc = r2MEC(eM1_3wc);% phase lock r value of MECI exc cells to MECII theta
e_M1r2MEC_3wp = r2MEC(eM1_3wp);
e_M1r2MEC_8wc = r2MEC(eM1_8wc);
e_M1r2MEC_8wp = r2MEC(eM1_8wp);

i_M1r2MEC_3wc = r2MEC(iM1_3wc);% phase lock r value of MECI inh cells to MECII theta
i_M1r2MEC_3wp = r2MEC(iM1_3wp);
i_M1r2MEC_8wc = r2MEC(iM1_8wc);
i_M1r2MEC_8wp = r2MEC(iM1_8wp);

e_M2r2MEC_3wc = r2MEC(eM2_3wc);% phase lock r value of MECII exc cells to MECII theta
e_M2r2MEC_3wp = r2MEC(eM2_3wp);
e_M2r2MEC_8wc = r2MEC(eM2_8wc);
e_M2r2MEC_8wp = r2MEC(eM2_8wp);

i_M2r2MEC_3wc = r2MEC(iM2_3wc);% phase lock r value of MECII inh cells to MECII theta
i_M2r2MEC_3wp = r2MEC(iM2_3wp);
i_M2r2MEC_8wc = r2MEC(iM2_8wc);
i_M2r2MEC_8wp = r2MEC(iM2_8wp);

e_M3r2MEC_3wc = r2MEC(eM3_3wc);% phase lock r value of MECIII exc cells to MECII theta
e_M3r2MEC_3wp = r2MEC(eM3_3wp);
e_M3r2MEC_8wc = r2MEC(eM3_8wc);
e_M3r2MEC_8wp = r2MEC(eM3_8wp);

i_M3r2MEC_3wc = r2MEC(iM3_3wc);% phase lock r value of MECIII inh cells to MECII theta
i_M3r2MEC_3wp = r2MEC(iM3_3wp);
i_M3r2MEC_8wc = r2MEC(iM3_8wc);
i_M3r2MEC_8wp = r2MEC(iM3_8wp);

%below is MEC cells PL to DG theta

e_M1r2DG_3wc = r2DG(eM1_3wc);% phase lock r value of MECI exc cells to DG theta
e_M1r2DG_3wp = r2DG(eM1_3wp);
e_M1r2DG_8wc = r2DG(eM1_8wc);
e_M1r2DG_8wp = r2DG(eM1_8wp);

i_M1r2DG_3wc = r2DG(iM1_3wc);% phase lock r value of MECI inh cells to DG theta
i_M1r2DG_3wp = r2DG(iM1_3wp);
i_M1r2DG_8wc = r2DG(iM1_8wc);
i_M1r2DG_8wp = r2DG(iM1_8wp);

e_M2r2DG_3wc = r2DG(eM2_3wc);% phase lock r value of MECII exc cells to DG theta
e_M2r2DG_3wp = r2DG(eM2_3wp);
e_M2r2DG_8wc = r2DG(eM2_8wc);
e_M2r2DG_8wp = r2DG(eM2_8wp);

i_M2r2DG_3wc = r2DG(iM2_3wc);% phase lock r value of MECII inh cells to DG theta
i_M2r2DG_3wp = r2DG(iM2_3wp);
i_M2r2DG_8wc = r2DG(iM2_8wc);
i_M2r2DG_8wp = r2DG(iM2_8wp);

e_M3r2DG_3wc = r2DG(eM3_3wc);% phase lock r value of MECIII exc cells to DG theta
e_M3r2DG_3wp = r2DG(eM3_3wp);
e_M3r2DG_8wc = r2DG(eM3_8wc);
e_M3r2DG_8wp = r2DG(eM3_8wp);

i_M3r2DG_3wc = r2DG(iM3_3wc);% phase lock r value of MECIII inh cells to DG theta
i_M3r2DG_3wp = r2DG(iM3_3wp);
i_M3r2DG_8wc = r2DG(iM3_8wc);
i_M3r2DG_8wp = r2DG(iM3_8wp);


%mu values by genotype
%below is MEC cells to CA1 mu
e_M1mu2CA1_3wc = mu2CA1(eM1_3wc);%mu values of M1 exc muefemuenced to CA1
e_M1mu2CA1_3wp = mu2CA1(eM1_3wp);
e_M1mu2CA1_8wc = mu2CA1(eM1_8wc);
e_M1mu2CA1_8wp = mu2CA1(eM1_8wp);

i_M1mu2CA1_3wc = mu2CA1(iM1_3wc);%mu values of M1 inh muefemuenced to CA1
i_M1mu2CA1_3wp = mu2CA1(iM1_3wp);
i_M1mu2CA1_8wc = mu2CA1(iM1_8wc);
i_M1mu2CA1_8wp = mu2CA1(iM1_8wp);

e_M2mu2CA1_3wc = mu2CA1(eM2_3wc);%mu values of M2 exc muefemuenced to CA1
e_M2mu2CA1_3wp = mu2CA1(eM2_3wp);
e_M2mu2CA1_8wc = mu2CA1(eM2_8wc);
e_M2mu2CA1_8wp = mu2CA1(eM2_8wp);

i_M2mu2CA1_3wc = mu2CA1(iM2_3wc);%mu values of M2 inh muefemuenced to CA1
i_M2mu2CA1_3wp = mu2CA1(iM2_3wp);
i_M2mu2CA1_8wc = mu2CA1(iM2_8wc);
i_M2mu2CA1_8wp = mu2CA1(iM2_8wp);

e_M3mu2CA1_3wc = mu2CA1(eM3_3wc);%mu values of M3 exc muefemuenced to CA1
e_M3mu2CA1_3wp = mu2CA1(eM3_3wp);
e_M3mu2CA1_8wc = mu2CA1(eM3_8wc);
e_M3mu2CA1_8wp = mu2CA1(eM3_8wp);

i_M3mu2CA1_3wc = mu2CA1(iM3_3wc);%mu values of M3 inh muefemuenced to CA1
i_M3mu2CA1_3wp = mu2CA1(iM3_3wp);
i_M3mu2CA1_8wc = mu2CA1(iM3_8wc);
i_M3mu2CA1_8wp = mu2CA1(iM3_8wp);

%below is MEC cells to MECII mu
e_M1mu2MEC_3wc = mu2MEC(eM1_3wc);%mu values of M1 exc muefemuenced to MECII
e_M1mu2MEC_3wp = mu2MEC(eM1_3wp);
e_M1mu2MEC_8wc = mu2MEC(eM1_8wc);
e_M1mu2MEC_8wp = mu2MEC(eM1_8wp);

i_M1mu2MEC_3wc = mu2MEC(iM1_3wc);%mu values of M1 inh muefemuenced to MECII
i_M1mu2MEC_3wp = mu2MEC(iM1_3wp);
i_M1mu2MEC_8wc = mu2MEC(iM1_8wc);
i_M1mu2MEC_8wp = mu2MEC(iM1_8wp);

e_M2mu2MEC_3wc = mu2MEC(eM2_3wc);%mu values of M2 exc muefemuenced to MECII
e_M2mu2MEC_3wp = mu2MEC(eM2_3wp);
e_M2mu2MEC_8wc = mu2MEC(eM2_8wc);
e_M2mu2MEC_8wp = mu2MEC(eM2_8wp);

i_M2mu2MEC_3wc = mu2MEC(iM2_3wc);%mu values of M2 inh muefemuenced to MECII
i_M2mu2MEC_3wp = mu2MEC(iM2_3wp);
i_M2mu2MEC_8wc = mu2MEC(iM2_8wc);
i_M2mu2MEC_8wp = mu2MEC(iM2_8wp);

e_M3mu2MEC_3wc = mu2MEC(eM3_3wc);%mu values of M3 exc muefemuenced to MECII
e_M3mu2MEC_3wp = mu2MEC(eM3_3wp);
e_M3mu2MEC_8wc = mu2MEC(eM3_8wc);
e_M3mu2MEC_8wp = mu2MEC(eM3_8wp);

i_M3mu2MEC_3wc = mu2MEC(iM3_3wc);%mu values of M3 inh muefemuenced to MECII
i_M3mu2MEC_3wp = mu2MEC(iM3_3wp);
i_M3mu2MEC_8wc = mu2MEC(iM3_8wc);
i_M3mu2MEC_8wp = mu2MEC(iM3_8wp);

%below is MEC cells to DG mu
e_M1mu2DG_3wc = mu2DG(eM1_3wc);%mu values of M1 exc muefemuenced to DG
e_M1mu2DG_3wp = mu2DG(eM1_3wp);
e_M1mu2DG_8wc = mu2DG(eM1_8wc);
e_M1mu2DG_8wp = mu2DG(eM1_8wp);

i_M1mu2DG_3wc = mu2DG(iM1_3wc);%mu values of M1 inh muefemuenced to DG
i_M1mu2DG_3wp = mu2DG(iM1_3wp);
i_M1mu2DG_8wc = mu2DG(iM1_8wc);
i_M1mu2DG_8wp = mu2DG(iM1_8wp);

e_M2mu2DG_3wc = mu2DG(eM2_3wc);%mu values of M2 exc muefemuenced to DG
e_M2mu2DG_3wp = mu2DG(eM2_3wp);
e_M2mu2DG_8wc = mu2DG(eM2_8wc);
e_M2mu2DG_8wp = mu2DG(eM2_8wp);

i_M2mu2DG_3wc = mu2DG(iM2_3wc);%mu values of M2 inh muefemuenced to DG
i_M2mu2DG_3wp = mu2DG(iM2_3wp);
i_M2mu2DG_8wc = mu2DG(iM2_8wc);
i_M2mu2DG_8wp = mu2DG(iM2_8wp);

e_M3mu2DG_3wc = mu2DG(eM3_3wc);%mu values of M3 exc muefemuenced to DG
e_M3mu2DG_3wp = mu2DG(eM3_3wp);
e_M3mu2DG_8wc = mu2DG(eM3_8wc);
e_M3mu2DG_8wp = mu2DG(eM3_8wp);

i_M3mu2DG_3wc = mu2DG(iM3_3wc);%mu values of M3 inh muefemuenced to DG
i_M3mu2DG_3wp = mu2DG(iM3_3wp);
i_M3mu2DG_8wc = mu2DG(iM3_8wc);
i_M3mu2DG_8wp = mu2DG(iM3_8wp);

%
%phaselock pval by genotype
%M1 circr pval to MECII
i_M12MECpval_3wc = pval2MEC(iM1_3wc);
i_M12MECpval_3wp = pval2MEC(iM1_3wp);
i_M12MECpval_8wc = pval2MEC(iM1_8wc);
i_M12MECpval_8wp = pval2MEC(iM1_8wp);
e_M12MECpval_3wc = pval2MEC(eM1_3wc);
e_M12MECpval_3wp = pval2MEC(eM1_3wp);
e_M12MECpval_8wc = pval2MEC(eM1_8wc);
e_M12MECpval_8wp = pval2MEC(eM1_8wp);
%M2 circr pval to MECII
i_M22MECpval_3wc = pval2MEC(iM2_3wc);
i_M22MECpval_3wp = pval2MEC(iM2_3wp);
i_M22MECpval_8wc = pval2MEC(iM2_8wc);
i_M22MECpval_8wp = pval2MEC(iM2_8wp);
e_M22MECpval_3wc = pval2MEC(eM2_3wc);
e_M22MECpval_3wp = pval2MEC(eM2_3wp);
e_M22MECpval_8wc = pval2MEC(eM2_8wc);
e_M22MECpval_8wp = pval2MEC(eM2_8wp);
%M3 circr pval to MECII
i_M32MECpval_3wc = pval2MEC(iM3_3wc);
i_M32MECpval_3wp = pval2MEC(iM3_3wp);
i_M32MECpval_8wc = pval2MEC(iM3_8wc);
i_M32MECpval_8wp = pval2MEC(iM3_8wp);
e_M32MECpval_3wc = pval2MEC(eM3_3wc);
e_M32MECpval_3wp = pval2MEC(eM3_3wp);
e_M32MECpval_8wc = pval2MEC(eM3_8wc);
e_M32MECpval_8wp = pval2MEC(eM3_8wp);

%M1 circr pval to DG
i_M12DGpval_3wc = pval2DG(iM1_3wc);
i_M12DGpval_3wp = pval2DG(iM1_3wp);
i_M12DGpval_8wc = pval2DG(iM1_8wc);
i_M12DGpval_8wp = pval2DG(iM1_8wp);
e_M12DGpval_3wc = pval2DG(eM1_3wc);
e_M12DGpval_3wp = pval2DG(eM1_3wp);
e_M12DGpval_8wc = pval2DG(eM1_8wc);
e_M12DGpval_8wp = pval2DG(eM1_8wp);
%M2 circr pval to DG
i_M22DGpval_3wc = pval2DG(iM2_3wc);
i_M22DGpval_3wp = pval2DG(iM2_3wp);
i_M22DGpval_8wc = pval2DG(iM2_8wc);
i_M22DGpval_8wp = pval2DG(iM2_8wp);
e_M22DGpval_3wc = pval2DG(eM2_3wc);
e_M22DGpval_3wp = pval2DG(eM2_3wp);
e_M22DGpval_8wc = pval2DG(eM2_8wc);
e_M22DGpval_8wp = pval2DG(eM2_8wp);
%M3 circr pval to DG
i_M32DGpval_3wc = pval2DG(iM3_3wc);
i_M32DGpval_3wp = pval2DG(iM3_3wp);
i_M32DGpval_8wc = pval2DG(iM3_8wc);
i_M32DGpval_8wp = pval2DG(iM3_8wp);
e_M32DGpval_3wc = pval2DG(eM3_3wc);
e_M32DGpval_3wp = pval2DG(eM3_3wp);
e_M32DGpval_8wc = pval2DG(eM3_8wc);
e_M32DGpval_8wp = pval2DG(eM3_8wp);

%M1 circr pval to CA1
i_M12CA1pval_3wc = pval2CA1(iM1_3wc);
i_M12CA1pval_3wp = pval2CA1(iM1_3wp);
i_M12CA1pval_8wc = pval2CA1(iM1_8wc);
i_M12CA1pval_8wp = pval2CA1(iM1_8wp);
e_M12CA1pval_3wc = pval2CA1(eM1_3wc);
e_M12CA1pval_3wp = pval2CA1(eM1_3wp);
e_M12CA1pval_8wc = pval2CA1(eM1_8wc);
e_M12CA1pval_8wp = pval2CA1(eM1_8wp);
%M2 circr pval to CA1
i_M22CA1pval_3wc = pval2CA1(iM2_3wc);
i_M22CA1pval_3wp = pval2CA1(iM2_3wp);
i_M22CA1pval_8wc = pval2CA1(iM2_8wc);
i_M22CA1pval_8wp = pval2CA1(iM2_8wp);
e_M22CA1pval_3wc = pval2CA1(eM2_3wc);
e_M22CA1pval_3wp = pval2CA1(eM2_3wp);
e_M22CA1pval_8wc = pval2CA1(eM2_8wc);
e_M22CA1pval_8wp = pval2CA1(eM2_8wp);
%M3 circr pval to CA1
i_M32CA1pval_3wc = pval2CA1(iM3_3wc);
i_M32CA1pval_3wp = pval2CA1(iM3_3wp);
i_M32CA1pval_8wc = pval2CA1(iM3_8wc);
i_M32CA1pval_8wp = pval2CA1(iM3_8wp);
e_M32CA1pval_3wc = pval2CA1(eM3_3wc);
e_M32CA1pval_3wp = pval2CA1(eM3_3wp);
e_M32CA1pval_8wc = pval2CA1(eM3_8wc);
e_M32CA1pval_8wp = pval2CA1(eM3_8wp);


%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%Plotting by group for group deviding purpose
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

figure(4);clf; scatter3(FRmean(e3wc),c(e3wc), asym(e3wc), 20, 'g');
 hold on; scatter3(FRmean(i3wc), c(i3wc), asym(i3wc), 20,'r');
 xlabel('Firing Rate')
 ylabel('c')
 zlabel('asym')
 title('3wc Firing Rate, c and asym');
 
figure(5);clf; scatter3(FRmean(e3wp),c(e3wp), asym(e3wp), 20, 'g');
 hold on; scatter3(FRmean(i3wp), c(i3wp), asym(i3wp), 20,'r');
 xlabel('Firing Rate')
 ylabel('c')
 zlabel('asym')
 title('3wp Firing Rate, c and asym');
 
 %below is 3w groups
 figure(6); clf; scatter3(FRmean(e3wc),c(e3wc), asym(e3wc), 20, 'MarkerFaceColor','g' );
 hold on; scatter3(FRmean(i3wc), c(i3wc), asym(i3wc), 20, 'MarkerFaceColor', 'r');
 hold on; scatter3(FRmean(e3wp),c(e3wp), asym(e3wp), 20, 'g');
 hold on; scatter3(FRmean(i3wp), c(i3wp), asym(i3wp), 20,'r');
 xlabel('Firing Rate')
 ylabel('c')
 zlabel('asym')
 title('Firing Rate, c and asym of 3wk groups');
 legend([{'3wc exc'},{ '3wc inh'},{ '3wp exc'}, {'3wp inh'}])
 %

  
 %below is 8w groups
 figure(7); clf; scatter3(FRmean(e8wc),c(e8wc), asym(e8wc), 20, 'MarkerFaceColor','g' );
 hold on; scatter3(FRmean(i8wc), c(i8wc), asym(i8wc), 20, 'MarkerFaceColor', 'r');
 hold on; scatter3(FRmean(e8wp),c(e8wp), asym(e8wp), 20, 'g');
 hold on; scatter3(FRmean(i8wp), c(i8wp), asym(i8wp), 20,'r');
 xlabel('Firing Rate')
 ylabel('c')
 zlabel('asym')
 title('Firing Rate, c and asym of 8wk groups');
 legend([{'8wc exc'},{ '8wc inh'}, { '8wp exc'}, {'8wp inh'}])
 

 
 %below is all cells regardless of groups
 figure(8); clf; scatter3(FRmean(iM1),c(iM1), asym(iM1), 20, 'MarkerFaceColor','m' );
 hold on; scatter3(FRmean(eM1), c(eM1), asym(eM1), 20, 'MarkerFaceColor', 'c');
 hold on; scatter3(FRmean(iM2),c(iM2), asym(iM2), 20, 'b');
 hold on; scatter3(FRmean(eM2), c(eM2), asym(eM2), 20,'r');
 hold on; scatter3(FRmean(iM3),c(iM3), asym(iM3), 20, 'y');
 hold on; scatter3(FRmean(eM3), c(eM3), asym(eM3), 20,'g');
 xlabel('Firing Rate')
 ylabel('c')
 zlabel('asym')
 title('Firing Rate, c and asym');
 legend([{'MEC1 inh'},{ 'MEC1 exc'},{ 'MECII inh'}, {'MECII exc'}, {'MECIII inh'},{'MECIII exc'}])
 
 %%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%Plot bar and ruster plot for mu and r values with stats
%original function scatterBars_SF(test_data, {'group1', 'group2'}, {'blue', 'red'});
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%MEC1 2 CA1 (Exc and Inh)%%   -- 3wk mu and r bar plots

titlelist = {};
pvallist = [];
% 
%MEC1 to CA1%
%3w mu exc   
% savepath='L:\Susie\SummerEphysHPCEC\AnalysisOutput\HPCEC_analysis\singleunit_phaseloc\MECunits\theta\MEC12CA1\';
% if exist(savepath)==0
%      mkdir(savepath);
% end
% data = {e_M1mu2CA1_3wc, e_M1mu2CA1_3wp};
% title_name = 'Mu Value of MEC1 Exc to Pyr Theta (3w)';
% %PLpval = e_M12CA1pval_3wc;
% scatterBars_mu_SF(data, {'3wc', '3wp'}, {'blue', 'red'}, title_name, savepath);
% [pval, k, K] = circ_kuipertest(data{1},data{2}); %test general difference
% [pval_k, f] = circ_ktest(data{1},data{2}); %test distribution
% [pval_w, t] = circ_wwtest(data{1},data{2}); %test phase shift
% titlelist(1,1) = {convertCharsToStrings(title_name)};
% pvallist(1,1) = pval;
% pvallist(1,2) = pval_k;
% pvallist(1,3) = pval_w;
% %3w r exc
% data = {e_M1r2CA1_3wc, e_M1r2CA1_3wp};
% title_name = 'R Value of MEC1 Exc to Pyr Theta (3w)';
% scatterBars_r_SF(data, {'3wc', '3wp'}, {'blue', 'red'}, title_name, savepath);
% pval = ranksum(data{1}, data{2});
% titlelist(2,1) = {convertCharsToStrings(title_name)};
% pvallist(2,1) = pval;
% %8w mu exc
% data = {e_M1mu2CA1_8wc, e_M1mu2CA1_8wp};
% title_name = ('Mu Value of MEC1 Exc to Pyr Theta (8w)');
% scatterBars_mu_SF(data, {'8wc', '8wp'}, {'blue', 'red'}, title_name, savepath);
% [pval, k, K] = circ_kuipertest(data{1},data{2});
% [pval_k, f] = circ_ktest(data{1},data{2});
% [pval_w, t] = circ_wwtest(data{1},data{2});
% titlelist(3,1) = {convertCharsToStrings(title_name)};
% pvallist(3,1) = pval;
% pvallist(3,2) = pval_k;
% pvallist(3,3) = pval_w;
% %8w r exc
% data = {e_M1r2CA1_8wc, e_M1r2CA1_8wp};
% title_name = 'R Value of MEC1 Exc to Pyr Theta (8w)';
% scatterBars_r_SF(data, {'8wc', '8wp'}, {'blue', 'red'}, title_name, savepath);
% pval = ranksum(data{1}, data{2});
% titlelist(4,1) = {convertCharsToStrings(title_name)};
% pvallist(4,1) = pval;
% 
% %3w mu Inh   
% data = {i_M1mu2CA1_3wc, i_M1mu2CA1_3wp};
% title_name = 'Mu Value of MEC1 Inh to Pyr Theta (3w)';
% scatterBars_mu_SF(data, {'3wc', '3wp'}, {'blue', 'red'}, title_name, savepath);
% [pval, k, K] = circ_kuipertest(data{1},data{2});
% [pval_k, f] = circ_ktest(data{1},data{2});
% [pval_w, t] = circ_wwtest(data{1},data{2});
% titlelist(5,1) = {convertCharsToStrings(title_name)};
% pvallist(5,1) = pval;
% pvallist(5,2) = pval_k;
% pvallist(5,3) = pval_w;
% %3w r Inh
% data = {i_M1r2CA1_3wc, i_M1r2CA1_3wp};
% title_name = 'R Value of MEC1 Inh to Pyr Theta (3w)';
% scatterBars_r_SF(data, {'3wc', '3wp'}, {'blue', 'red'}, title_name, savepath);
% pval = ranksum(data{1}, data{2});
% titlelist(6,1) = {convertCharsToStrings(title_name)};
% pvallist(6,1) = pval;
% %8w mu Inh
% data = {i_M1mu2CA1_8wc, i_M1mu2CA1_8wp};
% title_name = ('Mu Value of MEC1 Inh to Pyr Theta (8w)');
% scatterBars_mu_SF(data, {'8wc', '8wp'}, {'blue', 'red'}, title_name, savepath);
% [pval, k, K] = circ_kuipertest(data{1},data{2});
% [pval_k, f] = circ_ktest(data{1},data{2});
% [pval_w, t] = circ_wwtest(data{1},data{2});
% titlelist(7,1) = {convertCharsToStrings(title_name)};
% pvallist(7,1) = pval;
% pvallist(7,2) = pval_k;
% pvallist(7,3) = pval_w;
% %8w r Inh
% data = {i_M1r2CA1_8wc, i_M1r2CA1_8wp};
% title_name = 'R Value of MEC1 Inh to Pyr Theta (8w)';
% scatterBars_r_SF(data, {'8wc', '8wp'}, {'blue', 'red'}, title_name, savepath);
% pval = ranksum(data{1}, data{2});
% titlelist(8,1) = {convertCharsToStrings(title_name)};
% pvallist(8,1) = pval;

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%MEC2 to CA1 (Exc and Inh)%%   -- 3wk mu and r bar plots
savepath='L:\Susie\SummerEphysHPCEC\AnalysisOutput\HPCEC_analysis\singleunit_phaseloc\MECunits\theta\MEC22CA1\';
if exist(savepath)==0
     mkdir(savepath);
end

%3w mu exc   
data = {e_M2mu2CA1_3wc, e_M2mu2CA1_3wp};
%stats = {e_DG2CA1pval_3wc, e_DG2CA1pval_3wp};
title_name = 'Mu Value of MEC2 Exc to Pyr Theta (3w)';
scatterBars_mu_SF(data, {'3wc', '3wp'}, {'blue', 'red'}, title_name, savepath);
[pval, k, K] = circ_kuipertest(data{1},data{2});
[pval_k, f] = circ_ktest(data{1},data{2});
[pval_w, t] = circ_wwtest(data{1},data{2});
titlelist(9,1) = {convertCharsToStrings(title_name)};
pvallist(9,1) = pval;
pvallist(9,2) = pval_k;
pvallist(9,3) = pval_w;
%3w r exc
data = {e_M2r2CA1_3wc, e_M2r2CA1_3wp};
title_name = 'R Value of MEC2 Exc to Pyr Theta (3w)';
scatterBars_r_SF(data, {'3wc', '3wp'}, {'blue', 'red'}, title_name, savepath);
pval = ranksum(data{1}, data{2});
titlelist(10,1) = {convertCharsToStrings(title_name)};
pvallist(10,1) = pval;
%8w mu exc
data = {e_M2mu2CA1_8wc, e_M2mu2CA1_8wp};
title_name = ('Mu Value of MEC2 Exc to Pyr Theta (8w)');
scatterBars_mu_SF(data, {'8wc', '8wp'}, {'blue', 'red'}, title_name, savepath);
[pval, k, K] = circ_kuipertest(data{1},data{2});
[pval_k, f] = circ_ktest(data{1},data{2});
[pval_w, t] = circ_wwtest(data{1},data{2});
titlelist(11,1) = {convertCharsToStrings(title_name)};
pvallist(11,1) = pval;
pvallist(11,2) = pval_k;
pvallist(11,3) = pval_w;
%8w r exc
data = {e_M2r2CA1_8wc, e_M2r2CA1_8wp};
title_name = 'R Value of MEC2 Exc to Pyr Theta (8w)';
scatterBars_r_SF(data, {'8wc', '8wp'}, {'blue', 'red'}, title_name, savepath);
pval = ranksum(data{1}, data{2});
titlelist(12,1) = {convertCharsToStrings(title_name)};
pvallist(12,1) = pval;

%3w mu Inh   
data = {i_M2mu2CA1_3wc, i_M2mu2CA1_3wp};
title_name = 'Mu Value of MEC2 Inh to Pyr Theta (3w)';
scatterBars_mu_SF(data, {'3wc', '3wp'}, {'blue', 'red'}, title_name, savepath);
[pval, k, K] = circ_kuipertest(data{1},data{2});
[pval_k, f] = circ_ktest(data{1},data{2});
[pval_w, t] = circ_wwtest(data{1},data{2});
titlelist(13,1) = {convertCharsToStrings(title_name)};
pvallist(13,1) = pval;
pvallist(13,2) = pval_k;
pvallist(13,3) = pval_w;
%3w r Inh
data = {i_M2r2CA1_3wc, i_M2r2CA1_3wp};
title_name = 'R Value of MEC2 Inh to Pyr Theta (3w)';
scatterBars_r_SF(data, {'3wc', '3wp'}, {'blue', 'red'}, title_name, savepath);
pval = ranksum(data{1}, data{2});
titlelist(14,1) = {convertCharsToStrings(title_name)};
pvallist(14,1) = pval;
%8w mu Inh
data = {i_M2mu2CA1_8wc, i_M2mu2CA1_8wp};
title_name = ('Mu Value of MEC2 Inh to Pyr Theta (8w)');
scatterBars_mu_SF(data, {'8wc', '8wp'}, {'blue', 'red'}, title_name, savepath);
[pval, k, K] = circ_kuipertest(data{1},data{2});
[pval_k, f] = circ_ktest(data{1},data{2});
[pval_w, t] = circ_wwtest(data{1},data{2});
titlelist(15,1) = {convertCharsToStrings(title_name)};
pvallist(15,1) = pval;
pvallist(15,2) = pval_k;
pvallist(15,3) = pval_w;
%8w r Inh
data = {i_M2r2CA1_8wc, i_M2r2CA1_8wp};
title_name = 'R Value of MEC2 Inh to Pyr Theta (8w)';
scatterBars_r_SF(data, {'8wc', '8wp'}, {'blue', 'red'}, title_name, savepath);
pval = ranksum(data{1}, data{2});
titlelist(16,1) = {convertCharsToStrings(title_name)};
pvallist(16,1) = pval;


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%MEC3 to CA1 (Exc and Inh)%%   -- 3wk mu and r bar plots
savepath='L:\Susie\SummerEphysHPCEC\AnalysisOutput\HPCEC_analysis\singleunit_phaseloc\MECunits\theta\MEC32CA1\';
if exist(savepath)==0
     mkdir(savepath);
end

%3w mu exc   
data = {e_M3mu2CA1_3wc, e_M3mu2CA1_3wp};
%stats = {e_DG2CA1pval_3wc, e_DG2CA1pval_3wp};
title_name = 'Mu Value of MEC3 Exc to Pyr Theta (3w)';
scatterBars_mu_SF(data, {'3wc', '3wp'}, {'blue', 'red'}, title_name, savepath);
[pval, k, K] = circ_kuipertest(data{1},data{2});
[pval_k, f] = circ_ktest(data{1},data{2});
[pval_w, t] = circ_wwtest(data{1},data{2});
titlelist(17,1) = {convertCharsToStrings(title_name)};
pvallist(17,1) = pval;
pvallist(17,2) = pval_k;
pvallist(17,3) = pval_w;
%3w r exc
data = {e_M3r2CA1_3wc, e_M3r2CA1_3wp};
title_name = 'R Value of MEC3 Exc to Pyr Theta (3w)';
scatterBars_r_SF(data, {'3wc', '3wp'}, {'blue', 'red'}, title_name, savepath);
pval = ranksum(data{1}, data{2});
titlelist(18,1) = {convertCharsToStrings(title_name)};
pvallist(18,1) = pval;
%8w mu exc
data = {e_M3mu2CA1_8wc, e_M3mu2CA1_8wp};
title_name = ('Mu Value of MEC3 Exc to Pyr Theta (8w)');
scatterBars_mu_SF(data, {'8wc', '8wp'}, {'blue', 'red'}, title_name, savepath);
[pval, k, K] = circ_kuipertest(data{1},data{2});
[pval_k, f] = circ_ktest(data{1},data{2});
[pval_w, t] = circ_wwtest(data{1},data{2});
titlelist(19,1) = {convertCharsToStrings(title_name)};
pvallist(19,1) = pval;
pvallist(19,2) = pval_k;
pvallist(19,3) = pval_w;
%8w r exc
data = {e_M3r2CA1_8wc, e_M3r2CA1_8wp};
title_name = 'R Value of MEC3 Exc to Pyr Theta (8w)';
scatterBars_r_SF(data, {'8wc', '8wp'}, {'blue', 'red'}, title_name, savepath);
pval = ranksum(data{1}, data{2});
titlelist(20,1) = {convertCharsToStrings(title_name)};
pvallist(20,1) = pval;

%3w mu Inh   6/21 too less of units for now (only 2)
% data = {i_M3mu2CA1_3wc, i_M3mu2CA1_3wp};
% title_name = 'Mu Value of MEC3 Inh to Pyr Theta (3w)';
% scatterBars_mu_SF(data, {'3wc', '3wp'}, {'blue', 'red'}, title_name, savepath);
% [pval, k, K] = circ_kuipertest(data{1},data{2});
% [pval_k, f] = circ_ktest(data{1},data{2});
% [pval_w, t] = circ_wwtest(data{1},data{2});
% titlelist(21,1) = {convertCharsToStrings(title_name)};
% pvallist(21,1) = pval;
% pvallist(21,2) = pval_k;
% pvallist(21,3) = pval_w;
%3w r Inh
data = {i_M3r2CA1_3wc, i_M3r2CA1_3wp};
title_name = 'R Value of MEC3 Inh to Pyr Theta (3w)';
scatterBars_r_SF(data, {'3wc', '3wp'}, {'blue', 'red'}, title_name, savepath);
pval = ranksum(data{1}, data{2});
titlelist(22,1) = {convertCharsToStrings(title_name)};
pvallist(22,1) = pval;
%8w mu Inh
data = {i_M3mu2CA1_8wc, i_M3mu2CA1_8wp};
title_name = ('Mu Value of MEC3 Inh to Pyr Theta (8w)');
scatterBars_mu_SF(data, {'8wc', '8wp'}, {'blue', 'red'}, title_name, savepath);
[pval, k, K] = circ_kuipertest(data{1},data{2});
[pval_k, f] = circ_ktest(data{1},data{2});
[pval_w, t] = circ_wwtest(data{1},data{2});
titlelist(23,1) = {convertCharsToStrings(title_name)};
pvallist(23,1) = pval;
pvallist(23,2) = pval_k;
pvallist(23,3) = pval_w;
%8w r Inh
data = {i_M3r2CA1_8wc, i_M3r2CA1_8wp};
title_name = 'R Value of MEC3 Inh to Pyr Theta (8w)';
scatterBars_r_SF(data, {'8wc', '8wp'}, {'blue', 'red'}, title_name, savepath);
pval = ranksum(data{1}, data{2});
titlelist(24,1) = {convertCharsToStrings(title_name)};
pvallist(24,1) = pval;
% 
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%MEC1 to MEC2 (Exc and Inh)%%   -- 3wk mu and r bar plots
% savepath='L:\Susie\SummerEphysHPCEC\AnalysisOutput\HPCEC_analysis\singleunit_phaseloc\MECunits\theta\MEC12MECII\';
% if exist(savepath)==0
%      mkdir(savepath);
% end
% 
% %3w mu exc   
% data = {e_M1mu2MEC_3wc, e_M1mu2MEC_3wp};
% title_name = 'Mu Value of MEC1 Exc to MEC Theta (3w)';
% scatterBars_mu_SF(data, {'3wc', '3wp'}, {'blue', 'red'}, title_name, savepath);
% [pval, k, K] = circ_kuipertest(data{1},data{2});
% [pval_k, f] = circ_ktest(data{1},data{2});
% [pval_w, t] = circ_wwtest(data{1},data{2});
% titlelist(25,1) = {convertCharsToStrings(title_name)};
% pvallist(25,1) = pval;
% pvallist(25,2) = pval_k;
% pvallist(25,3) = pval_w;
% %3w r exc
% data = {e_M1r2MEC_3wc, e_M1r2MEC_3wp};
% title_name = 'R Value of MEC1 Exc to MEC Theta (3w)';
% scatterBars_r_SF(data, {'3wc', '3wp'}, {'blue', 'red'}, title_name, savepath);
% pval = ranksum(data{1}, data{2});
% titlelist(26,1) = {convertCharsToStrings(title_name)};
% pvallist(26,1) = pval;
% 
% %8w mu exc
% data = {e_M1mu2MEC_8wc, e_M1mu2MEC_8wp};
% title_name = ('Mu Value of MEC1 Exc to MEC Theta (8w)');
% scatterBars_mu_SF(data, {'8wc', '8wp'}, {'blue', 'red'}, title_name, savepath);
% [pval, k, K] = circ_kuipertest(data{1},data{2});
% [pval_k, f] = circ_ktest(data{1},data{2});
% [pval_w, t] = circ_wwtest(data{1},data{2});
% titlelist(27,1) = {convertCharsToStrings(title_name)};
% pvallist(27,1) = pval;
% pvallist(27,2) = pval_k;
% pvallist(27,3) = pval_w;
% %8w r exc
% data = {e_M1r2MEC_8wc, e_M1r2MEC_8wp};
% title_name = 'R Value of MEC1 Exc to MEC Theta (8w)';
% scatterBars_r_SF(data, {'8wc', '8wp'}, {'blue', 'red'}, title_name, savepath);
% pval = ranksum(data{1}, data{2});
% titlelist(28,1) = {convertCharsToStrings(title_name)};
% pvallist(28,1) = pval;
% 
% %3w mu Inh   
% data = {i_M1mu2MEC_3wc, i_M1mu2MEC_3wp};
% title_name = 'Mu Value of MEC1 Inh to MEC Theta (3w)';
% scatterBars_mu_SF(data, {'3wc', '3wp'}, {'blue', 'red'}, title_name, savepath);
% [pval, k, K] = circ_kuipertest(data{1},data{2});
% [pval_k, f] = circ_ktest(data{1},data{2});
% [pval_w, t] = circ_wwtest(data{1},data{2});
% titlelist(29,1) = {convertCharsToStrings(title_name)};
% pvallist(29,1) = pval;
% pvallist(29,2) = pval_k;
% pvallist(29,3) = pval_w;
% %3w r Inh
% data = {i_M1r2MEC_3wc, i_M1r2MEC_3wp};
% title_name = 'R Value of MEC1 Inh to MEC Theta (3w)';
% scatterBars_r_SF(data, {'3wc', '3wp'}, {'blue', 'red'}, title_name, savepath);
% pval = ranksum(data{1}, data{2});
% titlelist(30,1) = {convertCharsToStrings(title_name)};
% pvallist(30,1) = pval;
% %8w mu Inh
% data = {i_M1mu2MEC_8wc, i_M1mu2MEC_8wp};
% title_name = ('Mu Value of MEC1 Inh to MEC Theta (8w)');
% scatterBars_mu_SF(data, {'8wc', '8wp'}, {'blue', 'red'}, title_name, savepath);
% [pval, k, K] = circ_kuipertest(data{1},data{2});
% [pval_k, f] = circ_ktest(data{1},data{2});
% [pval_w, t] = circ_wwtest(data{1},data{2});
% titlelist(31,1) = {convertCharsToStrings(title_name)};
% pvallist(31,1) = pval;
% pvallist(31,2) = pval_k;
% pvallist(31,3) = pval_w;
% %8w r Inh
% data = {i_M1r2MEC_8wc, i_M1r2MEC_8wp};
% title_name = 'R Value of MEC1 Inh to MEC Theta (8w)';
% scatterBars_r_SF(data, {'8wc', '8wp'}, {'blue', 'red'}, title_name, savepath);
% pval = ranksum(data{1}, data{2});
% titlelist(32,1) = {convertCharsToStrings(title_name)};
% pvallist(32,1) = pval;


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%MEC2 2 MECII (Exc and Inh)%%   -- 3wk mu and r bar plots
savepath='L:\Susie\SummerEphysHPCEC\AnalysisOutput\HPCEC_analysis\singleunit_phaseloc\MECunits\theta\MEC22MECII\';
if exist(savepath)==0
     mkdir(savepath);
end

%3w mu exc   
data = {e_M2mu2MEC_3wc, e_M2mu2MEC_3wp};
title_name = 'Mu Value of MEC2 Exc to MEC Theta (3w)';
scatterBars_mu_SF(data, {'3wc', '3wp'}, {'blue', 'red'}, title_name, savepath);
[pval, k, K] = circ_kuipertest(data{1},data{2});
[pval_k, f] = circ_ktest(data{1},data{2});
[pval_w, t] = circ_wwtest(data{1},data{2});
titlelist(33,1) = {convertCharsToStrings(title_name)};
pvallist(33,1) = pval;
pvallist(33,2) = pval_k;
pvallist(33,3) = pval_w;
%3w r exc
data = {e_M2r2MEC_3wc, e_M2r2MEC_3wp};
title_name = 'R Value of MEC2 Exc to MEC Theta (3w)';
scatterBars_r_SF(data, {'3wc', '3wp'}, {'blue', 'red'}, title_name, savepath);
pval = ranksum(data{1}, data{2});
titlelist(34,1) = {convertCharsToStrings(title_name)};
pvallist(34,1) = pval;
%8w mu exc
data = {e_M2mu2MEC_8wc, e_M2mu2MEC_8wp};
title_name = ('Mu Value of MEC2 Exc to MEC Theta (8w)');
scatterBars_mu_SF(data, {'8wc', '8wp'}, {'blue', 'red'}, title_name, savepath);
[pval, k, K] = circ_kuipertest(data{1},data{2});
[pval_k, f] = circ_ktest(data{1},data{2});
[pval_w, t] = circ_wwtest(data{1},data{2});
titlelist(35,1) = {convertCharsToStrings(title_name)};
pvallist(35,1) = pval;
pvallist(35,2) = pval_k;
pvallist(35,3) = pval_w;
%8w r exc
data = {e_M2r2MEC_8wc, e_M2r2MEC_8wp};
title_name = 'R Value of MEC2 Exc to MEC Theta (8w)';
scatterBars_r_SF(data, {'8wc', '8wp'}, {'blue', 'red'}, title_name, savepath);
pval = ranksum(data{1}, data{2});
titlelist(36,1) = {convertCharsToStrings(title_name)};
pvallist(36,1) = pval;

%3w mu Inh   
data = {i_M2mu2MEC_3wc, i_M2mu2MEC_3wp};
title_name = 'Mu Value of MEC2 Inh to MEC Theta (3w)';
scatterBars_mu_SF(data, {'3wc', '3wp'}, {'blue', 'red'}, title_name, savepath);
[pval, k, K] = circ_kuipertest(data{1},data{2});
[pval_k, f] = circ_ktest(data{1},data{2});
[pval_w, t] = circ_wwtest(data{1},data{2});
titlelist(37,1) = {convertCharsToStrings(title_name)};
pvallist(37,1) = pval;
pvallist(37,2) = pval_k;
pvallist(37,3) = pval_w;
%3w r Inh
data = {i_M2r2MEC_3wc, i_M2r2MEC_3wp};
title_name = 'R Value of MEC2 Inh to MEC Theta (3w)';
scatterBars_r_SF(data, {'3wc', '3wp'}, {'blue', 'red'}, title_name, savepath);
pval = ranksum(data{1}, data{2});
titlelist(38,1) = {convertCharsToStrings(title_name)};
pvallist(38,1) = pval;
%8w mu Inh
data = {i_M2mu2MEC_8wc, i_M2mu2MEC_8wp};
title_name = ('Mu Value of MEC2 Inh to MEC Theta (8w)');
scatterBars_mu_SF(data, {'8wc', '8wp'}, {'blue', 'red'}, title_name, savepath);
[pval, k, K] = circ_kuipertest(data{1},data{2});
[pval_k, f] = circ_ktest(data{1},data{2});
[pval_w, t] = circ_wwtest(data{1},data{2});
titlelist(39,1) = {convertCharsToStrings(title_name)};
pvallist(39,1) = pval;
pvallist(39,2) = pval_k;
pvallist(39,3) = pval_w;
%8w r Inh
data = {i_M2r2MEC_8wc, i_M2r2MEC_8wp};
title_name = 'R Value of MEC2 Inh to MEC Theta (8w)';
scatterBars_r_SF(data, {'8wc', '8wp'}, {'blue', 'red'}, title_name, savepath);
pval = ranksum(data{1}, data{2});
titlelist(40,1) = {convertCharsToStrings(title_name)};
pvallist(40,1) = pval;

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%MEC3 2 MECII (Exc and Inh)%%   -- 3wk mu and r bar plots
savepath='L:\Susie\SummerEphysHPCEC\AnalysisOutput\HPCEC_analysis\singleunit_phaseloc\MECunits\theta\MEC32MECII\';
if exist(savepath)==0
     mkdir(savepath);
end

%3w mu exc   
data = {e_M3mu2MEC_3wc, e_M3mu2MEC_3wp};
title_name = 'Mu Value of MEC3 Exc to MEC Theta (3w)';
scatterBars_mu_SF(data, {'3wc', '3wp'}, {'blue', 'red'}, title_name, savepath);
[pval, k, K] = circ_kuipertest(data{1},data{2});
[pval_k, f] = circ_ktest(data{1},data{2});
[pval_w, t] = circ_wwtest(data{1},data{2});
titlelist(41,1) = {convertCharsToStrings(title_name)};
pvallist(41,1) = pval;
pvallist(41,2) = pval_k;
pvallist(41,3) = pval_w;
%3w r exc
data = {e_M3r2MEC_3wc, e_M3r2MEC_3wp};
title_name = 'R Value of MEC3 Exc to MEC Theta (3w)';
scatterBars_r_SF(data, {'3wc', '3wp'}, {'blue', 'red'}, title_name, savepath);
pval = ranksum(data{1}, data{2});
titlelist(42,1) = {convertCharsToStrings(title_name)};
pvallist(42,1) = pval;
%8w mu exc
data = {e_M3mu2MEC_8wc, e_M3mu2MEC_8wp};
title_name = ('Mu Value of MEC3 Exc to MEC Theta (8w)');
scatterBars_mu_SF(data, {'8wc', '8wp'}, {'blue', 'red'}, title_name, savepath);
[pval, k, K] = circ_kuipertest(data{1},data{2});
[pval_k, f] = circ_ktest(data{1},data{2});
[pval_w, t] = circ_wwtest(data{1},data{2});
titlelist(43,1) = {convertCharsToStrings(title_name)};
pvallist(43,1) = pval;
pvallist(43,2) = pval_k;
pvallist(43,3) = pval_w;
%8w r exc
data = {e_M3r2MEC_8wc, e_M3r2MEC_8wp};
title_name = 'R Value of MEC3 Exc to MEC Theta (8w)';
scatterBars_r_SF(data, {'8wc', '8wp'}, {'blue', 'red'}, title_name, savepath);
pval = ranksum(data{1}, data{2});
titlelist(44,1) = {convertCharsToStrings(title_name)};
pvallist(44,1) = pval;

%3w mu Inh    6/21 had to comment out, N too small
% data = {i_M3mu2MEC_3wc, i_M3mu2MEC_3wp};
% title_name = 'Mu Value of MEC3 Inh to MEC Theta (3w)';
% scatterBars_mu_SF(data, {'3wc', '3wp'}, {'blue', 'red'}, title_name, savepath);
% [pval, k, K] = circ_kuipertest(data{1},data{2});
% [pval_k, f] = circ_ktest(data{1},data{2});
% [pval_w, t] = circ_wwtest(data{1},data{2});
% titlelist(45,1) = {convertCharsToStrings(title_name)};
% pvallist(45,1) = pval;
% pvallist(45,2) = pval_k;
% pvallist(45,3) = pval_w;
%3w r Inh
data = {i_M3r2MEC_3wc, i_M3r2MEC_3wp};
title_name = 'R Value of MEC3 Inh to MEC Theta (3w)';
scatterBars_r_SF(data, {'3wc', '3wp'}, {'blue', 'red'}, title_name, savepath);
pval = ranksum(data{1}, data{2});
titlelist(46,1) = {convertCharsToStrings(title_name)};
pvallist(46,1) = pval;
%8w mu Inh
data = {i_M3mu2MEC_8wc, i_M3mu2MEC_8wp};
title_name = ('Mu Value of MEC3 Inh to MEC Theta (8w)');
scatterBars_mu_SF(data, {'8wc', '8wp'}, {'blue', 'red'}, title_name, savepath);
[pval, k, K] = circ_kuipertest(data{1},data{2});
[pval_k, f] = circ_ktest(data{1},data{2});
[pval_w, t] = circ_wwtest(data{1},data{2});
titlelist(47,1) = {convertCharsToStrings(title_name)};
pvallist(47,1) = pval;
pvallist(47,2) = pval_k;
pvallist(47,3) = pval_w;
%8w r Inh
data = {i_M3r2MEC_8wc, i_M3r2MEC_8wp};
title_name = 'R Value of MEC3 Inh to MEC Theta (8w)';
scatterBars_r_SF(data, {'8wc', '8wp'}, {'blue', 'red'}, title_name, savepath);
pval = ranksum(data{1}, data{2});
titlelist(48,1) = {convertCharsToStrings(title_name)};
pvallist(48,1) = pval;


%MEC1 to DG%
%3w mu exc   
% savepath='L:\Susie\SummerEphysHPCEC\AnalysisOutput\HPCEC_analysis\singleunit_phaseloc\MECunits\theta\MEC12DG\';
% if exist(savepath)==0
%      mkdir(savepath);
% end
% data = {e_M1mu2DG_3wc, e_M1mu2DG_3wp};
% title_name = 'Mu Value of MEC1 Exc to DG Theta (3w)';
% %PLpval = e_M12DGpval_3wc;
% scatterBars_mu_SF(data, {'3wc', '3wp'}, {'blue', 'red'}, title_name, savepath);
% [pval, k, K] = circ_kuipertest(data{1},data{2}); %test general difference
% [pval_k, f] = circ_ktest(data{1},data{2}); %test distribution
% [pval_w, t] = circ_wwtest(data{1},data{2}); %test phase shift
% titlelist(49,1) = {convertCharsToStrings(title_name)};
% pvallist(49,1) = pval;
% pvallist(49,2) = pval_k;
% pvallist(49,3) = pval_w;
% %3w r exc
% data = {e_M1r2DG_3wc, e_M1r2DG_3wp};
% title_name = 'R Value of MEC1 Exc to DG Theta (3w)';
% scatterBars_r_SF(data, {'3wc', '3wp'}, {'blue', 'red'}, title_name, savepath);
% pval = ranksum(data{1}, data{2});
% titlelist(50,1) = {convertCharsToStrings(title_name)};
% pvallist(50,1) = pval;
% %8w mu exc
% data = {e_M1mu2DG_8wc, e_M1mu2DG_8wp};
% title_name = ('Mu Value of MEC1 Exc to DG Theta (8w)');
% scatterBars_mu_SF(data, {'8wc', '8wp'}, {'blue', 'red'}, title_name, savepath);
% [pval, k, K] = circ_kuipertest(data{1},data{2});
% [pval_k, f] = circ_ktest(data{1},data{2});
% [pval_w, t] = circ_wwtest(data{1},data{2});
% titlelist(51,1) = {convertCharsToStrings(title_name)};
% pvallist(51,1) = pval;
% pvallist(51,2) = pval_k;
% pvallist(51,3) = pval_w;
% %8w r exc
% data = {e_M1r2DG_8wc, e_M1r2DG_8wp};
% title_name = 'R Value of MEC1 Exc to DG Theta (8w)';
% scatterBars_r_SF(data, {'8wc', '8wp'}, {'blue', 'red'}, title_name, savepath);
% pval = ranksum(data{1}, data{2});
% titlelist(52,1) = {convertCharsToStrings(title_name)};
% pvallist(52,1) = pval;
% 
% %3w mu Inh   
% data = {i_M1mu2DG_3wc, i_M1mu2DG_3wp};
% title_name = 'Mu Value of MEC1 Inh to DG Theta (3w)';
% scatterBars_mu_SF(data, {'3wc', '3wp'}, {'blue', 'red'}, title_name, savepath);
% [pval, k, K] = circ_kuipertest(data{1},data{2});
% [pval_k, f] = circ_ktest(data{1},data{2});
% [pval_w, t] = circ_wwtest(data{1},data{2});
% titlelist(53,1) = {convertCharsToStrings(title_name)};
% pvallist(53,1) = pval;
% pvallist(53,2) = pval_k;
% pvallist(53,3) = pval_w;
% %3w r Inh
% data = {i_M1r2DG_3wc, i_M1r2DG_3wp};
% title_name = 'R Value of MEC1 Inh to DG Theta (3w)';
% scatterBars_r_SF(data, {'3wc', '3wp'}, {'blue', 'red'}, title_name, savepath);
% pval = ranksum(data{1}, data{2});
% titlelist(54,1) = {convertCharsToStrings(title_name)};
% pvallist(54,1) = pval;
% %8w mu Inh
% data = {i_M1mu2DG_8wc, i_M1mu2DG_8wp};
% title_name = ('Mu Value of MEC1 Inh to DG Theta (8w)');
% scatterBars_mu_SF(data, {'8wc', '8wp'}, {'blue', 'red'}, title_name, savepath);
% [pval, k, K] = circ_kuipertest(data{1},data{2});
% [pval_k, f] = circ_ktest(data{1},data{2});
% [pval_w, t] = circ_wwtest(data{1},data{2});
% titlelist(55,1) = {convertCharsToStrings(title_name)};
% pvallist(55,1) = pval;
% pvallist(55,2) = pval_k;
% pvallist(55,3) = pval_w;
% %8w r Inh
% data = {i_M1r2DG_8wc, i_M1r2DG_8wp};
% title_name = 'R Value of MEC1 Inh to DG Theta (8w)';
% scatterBars_r_SF(data, {'8wc', '8wp'}, {'blue', 'red'}, title_name, savepath);
% pval = ranksum(data{1}, data{2});
% titlelist(56,1) = {convertCharsToStrings(title_name)};
% pvallist(56,1) = pval;

%MEC2 to DG%
%3w mu exc   
savepath='L:\Susie\SummerEphysHPCEC\AnalysisOutput\HPCEC_analysis\singleunit_phaseloc\MECunits\theta\MEC22DG\';
if exist(savepath)==0
     mkdir(savepath);
end
data = {e_M2mu2DG_3wc, e_M2mu2DG_3wp};
title_name = 'Mu Value of MEC2 Exc to DG Theta (3w)';
%PLpval = e_M22DGpval_3wc;
scatterBars_mu_SF(data, {'3wc', '3wp'}, {'blue', 'red'}, title_name, savepath);
[pval, k, K] = circ_kuipertest(data{1},data{2}); %test general difference
[pval_k, f] = circ_ktest(data{1},data{2}); %test distribution
[pval_w, t] = circ_wwtest(data{1},data{2}); %test phase shift
titlelist(57,1) = {convertCharsToStrings(title_name)};
pvallist(57,1) = pval;
pvallist(57,2) = pval_k;
pvallist(57,3) = pval_w;
%3w r exc
data = {e_M2r2DG_3wc, e_M2r2DG_3wp};
title_name = 'R Value of MEC2 Exc to DG Theta (3w)';
scatterBars_r_SF(data, {'3wc', '3wp'}, {'blue', 'red'}, title_name, savepath);
pval = ranksum(data{1}, data{2});
titlelist(58,1) = {convertCharsToStrings(title_name)};
pvallist(58,1) = pval;
%8w mu exc
data = {e_M2mu2DG_8wc, e_M2mu2DG_8wp};
title_name = ('Mu Value of MEC2 Exc to DG Theta (8w)');
scatterBars_mu_SF(data, {'8wc', '8wp'}, {'blue', 'red'}, title_name, savepath);
[pval, k, K] = circ_kuipertest(data{1},data{2});
[pval_k, f] = circ_ktest(data{1},data{2});
[pval_w, t] = circ_wwtest(data{1},data{2});
titlelist(59,1) = {convertCharsToStrings(title_name)};
pvallist(59,1) = pval;
pvallist(59,2) = pval_k;
pvallist(59,3) = pval_w;
%8w r exc
data = {e_M2r2DG_8wc, e_M2r2DG_8wp};
title_name = 'R Value of MEC2 Exc to DG Theta (8w)';
scatterBars_r_SF(data, {'8wc', '8wp'}, {'blue', 'red'}, title_name, savepath);
pval = ranksum(data{1}, data{2});
titlelist(60,1) = {convertCharsToStrings(title_name)};
pvallist(60,1) = pval;

%3w mu Inh   
data = {i_M2mu2DG_3wc, i_M2mu2DG_3wp};
title_name = 'Mu Value of MEC2 Inh to DG Theta (3w)';
scatterBars_mu_SF(data, {'3wc', '3wp'}, {'blue', 'red'}, title_name, savepath);
[pval, k, K] = circ_kuipertest(data{1},data{2});
[pval_k, f] = circ_ktest(data{1},data{2});
[pval_w, t] = circ_wwtest(data{1},data{2});
titlelist(61,1) = {convertCharsToStrings(title_name)};
pvallist(61,1) = pval;
pvallist(61,2) = pval_k;
pvallist(61,3) = pval_w;
%3w r Inh
data = {i_M2r2DG_3wc, i_M2r2DG_3wp};
title_name = 'R Value of MEC2 Inh to DG Theta (3w)';
scatterBars_r_SF(data, {'3wc', '3wp'}, {'blue', 'red'}, title_name, savepath);
pval = ranksum(data{1}, data{2});
titlelist(62,1) = {convertCharsToStrings(title_name)};
pvallist(62,1) = pval;
%8w mu Inh
data = {i_M2mu2DG_8wc, i_M2mu2DG_8wp};
title_name = ('Mu Value of MEC2 Inh to DG Theta (8w)');
scatterBars_mu_SF(data, {'8wc', '8wp'}, {'blue', 'red'}, title_name, savepath);
[pval, k, K] = circ_kuipertest(data{1},data{2});
[pval_k, f] = circ_ktest(data{1},data{2});
[pval_w, t] = circ_wwtest(data{1},data{2});
titlelist(63,1) = {convertCharsToStrings(title_name)};
pvallist(63,1) = pval;
pvallist(63,2) = pval_k;
pvallist(63,3) = pval_w;
%8w r Inh
data = {i_M2r2DG_8wc, i_M2r2DG_8wp};
title_name = 'R Value of MEC2 Inh to DG Theta (8w)';
scatterBars_r_SF(data, {'8wc', '8wp'}, {'blue', 'red'}, title_name, savepath);
pval = ranksum(data{1}, data{2});
titlelist(64,1) = {convertCharsToStrings(title_name)};
pvallist(64,1) = pval;

%MEC3 to DG%
%3w mu exc   
savepath='L:\Susie\SummerEphysHPCEC\AnalysisOutput\HPCEC_analysis\singleunit_phaseloc\MECunits\theta\MEC32DG\';
if exist(savepath)==0
     mkdir(savepath);
end
data = {e_M3mu2DG_3wc, e_M3mu2DG_3wp};
title_name = 'Mu Value of MEC3 Exc to DG Theta (3w)';
%PLpval = e_M32DGpval_3wc;
scatterBars_mu_SF(data, {'3wc', '3wp'}, {'blue', 'red'}, title_name, savepath);
[pval, k, K] = circ_kuipertest(data{1},data{2}); %test general difference
[pval_k, f] = circ_ktest(data{1},data{2}); %test distribution
[pval_w, t] = circ_wwtest(data{1},data{2}); %test phase shift
titlelist(65,1) = {convertCharsToStrings(title_name)};
pvallist(65,1) = pval;
pvallist(65,2) = pval_k;
pvallist(65,3) = pval_w;
%3w r exc
data = {e_M3r2DG_3wc, e_M3r2DG_3wp};
title_name = 'R Value of MEC3 Exc to DG Theta (3w)';
scatterBars_r_SF(data, {'3wc', '3wp'}, {'blue', 'red'}, title_name, savepath);
pval = ranksum(data{1}, data{2});
titlelist(66,1) = {convertCharsToStrings(title_name)};
pvallist(66,1) = pval;
%8w mu exc
data = {e_M3mu2DG_8wc, e_M3mu2DG_8wp};
title_name = ('Mu Value of MEC3 Exc to DG Theta (8w)');
scatterBars_mu_SF(data, {'8wc', '8wp'}, {'blue', 'red'}, title_name, savepath);
[pval, k, K] = circ_kuipertest(data{1},data{2});
[pval_k, f] = circ_ktest(data{1},data{2});
[pval_w, t] = circ_wwtest(data{1},data{2});
titlelist(67,1) = {convertCharsToStrings(title_name)};
pvallist(67,1) = pval;
pvallist(67,2) = pval_k;
pvallist(67,3) = pval_w;
%8w r exc
data = {e_M3r2DG_8wc, e_M3r2DG_8wp};
title_name = 'R Value of MEC3 Exc to DG Theta (8w)';
scatterBars_r_SF(data, {'8wc', '8wp'}, {'blue', 'red'}, title_name, savepath);
pval = ranksum(data{1}, data{2});
titlelist(68,1) = {convertCharsToStrings(title_name)};
pvallist(68,1) = pval;

%3w mu Inh   had to comment out, too less units 7/12
% data = {i_M3mu2DG_3wc, i_M3mu2DG_3wp};
% title_name = 'Mu Value of MEC3 Inh to DG Theta (3w)';
% scatterBars_mu_SF(data, {'3wc', '3wp'}, {'blue', 'red'}, title_name, savepath);
% [pval, k, K] = circ_kuipertest(data{1},data{2});
% [pval_k, f] = circ_ktest(data{1},data{2});
% [pval_w, t] = circ_wwtest(data{1},data{2});
% titlelist(69,1) = {convertCharsToStrings(title_name)};
% pvallist(69,1) = pval;
% pvallist(69,2) = pval_k;
% pvallist(69,3) = pval_w;
%3w r Inh
data = {i_M3r2DG_3wc, i_M3r2DG_3wp};
title_name = 'R Value of MEC3 Inh to DG Theta (3w)';
scatterBars_r_SF(data, {'3wc', '3wp'}, {'blue', 'red'}, title_name, savepath);
pval = ranksum(data{1}, data{2});
titlelist(70,1) = {convertCharsToStrings(title_name)};
pvallist(70,1) = pval;
%8w mu Inh
data = {i_M3mu2DG_8wc, i_M3mu2DG_8wp};
title_name = ('Mu Value of MEC3 Inh to DG Theta (8w)');
scatterBars_mu_SF(data, {'8wc', '8wp'}, {'blue', 'red'}, title_name, savepath);
[pval, k, K] = circ_kuipertest(data{1},data{2});
[pval_k, f] = circ_ktest(data{1},data{2});
[pval_w, t] = circ_wwtest(data{1},data{2});
titlelist(71,1) = {convertCharsToStrings(title_name)};
pvallist(71,1) = pval;
pvallist(71,2) = pval_k;
pvallist(71,3) = pval_w;
%8w r Inh
data = {i_M3r2DG_8wc, i_M3r2DG_8wp};
title_name = 'R Value of MEC3 Inh to DG Theta (8w)';
scatterBars_r_SF(data, {'8wc', '8wp'}, {'blue', 'red'}, title_name, savepath);
pval = ranksum(data{1}, data{2});
titlelist(72,1) = {convertCharsToStrings(title_name)};
pvallist(72,1) = pval;


mu_r_pvaltable = table(titlelist, pvallist); %write pval to a table
writetable(mu_r_pvaltable, 'L:\Susie\SummerEphysHPCEC\AnalysisOutput\HPCEC_analysis\singleunit_phaseloc\MECunits\theta\mu_r_pvaltable_MEC_sperate.csv','Delimiter',',') %first col: name; second col: pval for kuipertest/Mann-Whitney test; third col: pval for ktest (for centralization). forth col: Wwtest (for equal means) 


%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%plot MEC cells phase locking to HPC CA1 and MECII theta
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%%
%below is to plot OVERLAYED polarscatter plot
%%%% MECI cell PL to MEC2 theta %%%%
savepath = 'L:\Susie\SummerEphysHPCEC\AnalysisOutput\HPCEC_analysis\singleunit_phaseloc\MECunits\theta\MEC12CA1\';
if exist(savepath)==0
     mkdir(savepath);
end
% figure('Renderer', 'painters', 'Position', [10 10 1500 1000])

% %figure(500); %MEC1 2 CA1
% subplot(2,2,1); %3w
% polarscatter(e_M1mu2CA1_3wc+pi, e_M1r2CA1_3wc,40,'MarkerFaceColor','b','MarkerFaceAlpha',.35)  %plot 3wc exc
% hold on
% polarscatter(e_M1mu2CA1_3wp+pi,e_M1r2CA1_3wp,40,'MarkerFaceColor','m','MarkerFaceAlpha',.5)%plot 3wp exc
% title('3wk MEC1 Exc to CA1');
% %rlim([0 0.8])
% subplot(2,2,2); %8w
% polarscatter(e_M1mu2CA1_8wc+pi,e_M1r2CA1_8wc,40,'MarkerFaceColor','b','MarkerFaceAlpha',.5)    %plot 8wp exc
% hold on
% polarscatter(e_M1mu2CA1_8wp+pi,e_M1r2CA1_8wp,40,'MarkerFaceColor','r','MarkerFaceAlpha',.5)   %plot 8wp exc
% title('8wk MEC1 Exc to CA1');
% %rlim([0 0.8])
% subplot(2,2,3); %3w
% polarscatter(i_M1mu2CA1_3wc+pi, i_M1r2CA1_3wc,40,'MarkerFaceColor','b','MarkerFaceAlpha',.35)  %plot 3wc inh
% hold on
% polarscatter(i_M1mu2CA1_3wp+pi,i_M1r2CA1_3wp,40,'MarkerFaceColor','m','MarkerFaceAlpha',.5)%plot 3wp inh
% title('3wk MEC1 Inh to CA1');
% %rlim([0 0.8])
% subplot(2,2,4); %8w
% polarscatter(i_M1mu2CA1_8wc+pi,i_M1r2CA1_8wc,40,'MarkerFaceColor','b','MarkerFaceAlpha',.5)    %plot 8wp inh
% hold on
% polarscatter(i_M1mu2CA1_8wp+pi,i_M1r2CA1_8wp,40,'MarkerFaceColor','r','MarkerFaceAlpha',.5)   %plot 8wp inh
% title('8wk MEC1 Inh to CA1');
% %rlim([0 0.8])
% saveas(gca, fullfile(savepath, 'MEC1 Units to CA1 theta phase locking'), 'png');
% 
% savepath = 'L:\Susie\SummerEphysHPCEC\AnalysisOutput\HPCEC_analysis\singleunit_phaseloc\MECunits\theta\MEC12MECII\';
% if exist(savepath)==0
%      mkdir(savepath);
% end
% figure('Renderer', 'painters', 'Position', [10 10 1500 1000])

% %figure(501); %MEC1 2 MECII
% subplot(2,2,1); %3w
% polarscatter(e_M1mu2MEC_3wc+pi, e_M1r2MEC_3wc,40,'MarkerFaceColor','b','MarkerFaceAlpha',.35)  %plot 3wc exc
% hold on
% polarscatter(e_M1mu2MEC_3wp+pi,e_M1r2MEC_3wp,40,'MarkerFaceColor','m','MarkerFaceAlpha',.5)%plot 3wp exc
% title('3wk MEC1 Exc to MECII');
% %rlim([0 0.8])
% subplot(2,2,2); %8w
% polarscatter(e_M1mu2MEC_8wc+pi,e_M1r2MEC_8wc,40,'MarkerFaceColor','b','MarkerFaceAlpha',.5)    %plot 8wp exc
% hold on
% polarscatter(e_M1mu2MEC_8wp+pi,e_M1r2MEC_8wp,40,'MarkerFaceColor','r','MarkerFaceAlpha',.5)   %plot 8wp exc
% title('8wk MEC1 Exc to MECII');
% %rlim([0 0.8])
% subplot(2,2,3); %3w
% polarscatter(i_M1mu2MEC_3wc+pi, i_M1r2MEC_3wc,40,'MarkerFaceColor','b','MarkerFaceAlpha',.35)  %plot 3wc inh
% hold on
% polarscatter(i_M1mu2MEC_3wp+pi,i_M1r2MEC_3wp,40,'MarkerFaceColor','m','MarkerFaceAlpha',.5)%plot 3wp inh
% title('3wk MEC1 Inh to MECII');
% %rlim([0 0.8])
% subplot(2,2,4); %8w
% polarscatter(i_M1mu2MEC_8wc+pi,i_M1r2MEC_8wc,40,'MarkerFaceColor','b','MarkerFaceAlpha',.5)    %plot 8wp inh
% hold on
% polarscatter(i_M1mu2MEC_8wp+pi,i_M1r2MEC_8wp,40,'MarkerFaceColor','r','MarkerFaceAlpha',.5)   %plot 8wp inh
% title('8wk MEC1 Inh to MECII');
% %rlim([0 0.8])
% saveas(gca, fullfile(savepath, 'MEC1 Units to MECII theta phase locking'), 'png');

savepath = 'L:\Susie\SummerEphysHPCEC\AnalysisOutput\HPCEC_analysis\singleunit_phaseloc\MECunits\theta\MEC22CA1\';
if exist(savepath)==0
     mkdir(savepath);
end
figure('Renderer', 'painters', 'Position', [10 10 1500 1000])

%figure(502); %MEC2 2 CA1
subplot(2,2,1); %3w
polarscatter(e_M2mu2CA1_3wc+pi, e_M2r2CA1_3wc,40,'MarkerFaceColor','b','MarkerFaceAlpha',.35)  %plot 3wc exc
hold on
polarscatter(e_M2mu2CA1_3wp+pi,e_M2r2CA1_3wp,40,'MarkerFaceColor','m','MarkerFaceAlpha',.5)%plot 3wp exc
title('3wk MEC2 Exc to CA1');
%rlim([0 0.8])
subplot(2,2,2); %8w
polarscatter(e_M2mu2CA1_8wc+pi,e_M2r2CA1_8wc,40,'MarkerFaceColor','b','MarkerFaceAlpha',.5)    %plot 8wp exc
hold on
polarscatter(e_M2mu2CA1_8wp+pi,e_M2r2CA1_8wp,40,'MarkerFaceColor','r','MarkerFaceAlpha',.5)   %plot 8wp exc
title('8wk MEC2 Exc to CA1');
%rlim([0 0.8])
subplot(2,2,3); %3w
polarscatter(i_M2mu2CA1_3wc+pi, i_M2r2CA1_3wc,40,'MarkerFaceColor','b','MarkerFaceAlpha',.35)  %plot 3wc inh
hold on
polarscatter(i_M2mu2CA1_3wp+pi,i_M2r2CA1_3wp,40,'MarkerFaceColor','m','MarkerFaceAlpha',.5)%plot 3wp inh
title('3wk MEC2 Inh to CA1');
%rlim([0 0.8])
subplot(2,2,4); %8w
polarscatter(i_M2mu2CA1_8wc+pi,i_M2r2CA1_8wc,40,'MarkerFaceColor','b','MarkerFaceAlpha',.5)    %plot 8wp inh
hold on
polarscatter(i_M2mu2CA1_8wp+pi,i_M2r2CA1_8wp,40,'MarkerFaceColor','r','MarkerFaceAlpha',.5)   %plot 8wp inh
title('8wk MEC2 Inh to CA1');
%rlim([0 0.8])
saveas(gca, fullfile(savepath, 'MEC2 Units to CA1 theta phase locking'), 'png');

savepath = 'L:\Susie\SummerEphysHPCEC\AnalysisOutput\HPCEC_analysis\singleunit_phaseloc\MECunits\theta\MEC22MECII\';
if exist(savepath)==0
     mkdir(savepath);
end
figure('Renderer', 'painters', 'Position', [10 10 1500 1000])
%figure(503); %MEC2 2 MECII
subplot(2,2,1); %3w
polarscatter(e_M2mu2MEC_3wc+pi, e_M2r2MEC_3wc,40,'MarkerFaceColor','b','MarkerFaceAlpha',.35)  %plot 3wc exc
hold on
polarscatter(e_M2mu2MEC_3wp+pi,e_M2r2MEC_3wp,40,'MarkerFaceColor','m','MarkerFaceAlpha',.5)%plot 3wp exc
title('3w MEC2 Exc to MECII');
%rlim([0 0.8])
subplot(2,2,2); %8w
polarscatter(e_M2mu2MEC_8wc+pi,e_M2r2MEC_8wc,40,'MarkerFaceColor','b','MarkerFaceAlpha',.5)    %plot 8wp exc
hold on
polarscatter(e_M2mu2MEC_8wp+pi,e_M2r2MEC_8wp,40,'MarkerFaceColor','r','MarkerFaceAlpha',.5)   %plot 8wp exc
title('8w MEC2 Exc to MECII');
%rlim([0 0.8])
subplot(2,2,3); %3w
polarscatter(i_M2mu2MEC_3wc+pi, i_M2r2MEC_3wc,40,'MarkerFaceColor','b','MarkerFaceAlpha',.35)  %plot 3wc inh
hold on
polarscatter(i_M2mu2MEC_3wp+pi,i_M2r2MEC_3wp,40,'MarkerFaceColor','m','MarkerFaceAlpha',.5)%plot 3wp inh
title('3wk MEC2 Inh to MECII');
%rlim([0 0.8])
subplot(2,2,4); %8w
polarscatter(i_M2mu2MEC_8wc+pi,i_M2r2MEC_8wc,40,'MarkerFaceColor','b','MarkerFaceAlpha',.5)   %plot 8wc inh
hold on
polarscatter(i_M2mu2MEC_8wp+pi,i_M2r2MEC_8wp,40,'MarkerFaceColor','r','MarkerFaceAlpha',.5)     %plot 8wp exc
title('8wk MEC2 Inh to MECII');
%rlim([0 0.8])
saveas(gca, fullfile(savepath, 'MEC2 Units to MECII theta phase locking'), 'png');

savepath = 'L:\Susie\SummerEphysHPCEC\AnalysisOutput\HPCEC_analysis\singleunit_phaseloc\MECunits\theta\MEC32CA1\';
if exist(savepath)==0
     mkdir(savepath);
end
figure('Renderer', 'painters', 'Position', [10 10 1500 1000])
%figure(504); %MEC3 2 CA1
subplot(2,2,1); %3w
polarscatter(e_M3mu2CA1_3wc+pi, e_M3r2CA1_3wc,40,'MarkerFaceColor','b','MarkerFaceAlpha',.35)  %plot 3wc exc
hold on
polarscatter(e_M3mu2CA1_3wp+pi,e_M3r2CA1_3wp,40,'MarkerFaceColor','m','MarkerFaceAlpha',.5)%plot 3wp exc
title('3wk MEC3 Exc to CA1');
%rlim([0 0.8])
subplot(2,2,2); %8w
polarscatter(e_M3mu2CA1_8wc+pi,e_M3r2CA1_8wc,40,'MarkerFaceColor','b','MarkerFaceAlpha',.5)    %plot 8wp exc
hold on
polarscatter(e_M3mu2CA1_8wp+pi,e_M3r2CA1_8wp,40,'MarkerFaceColor','r','MarkerFaceAlpha',.5)   %plot 8wp exc
title('8wk MEC3 Exc to CA1');
%rlim([0 0.8])
subplot(2,2,3); %3w
polarscatter(i_M3mu2CA1_3wc+pi, i_M3r2CA1_3wc,40,'MarkerFaceColor','b','MarkerFaceAlpha',.35)  %plot 3wc inh
hold on
polarscatter(i_M3mu2CA1_3wp+pi,i_M3r2CA1_3wp,40,'MarkerFaceColor','m','MarkerFaceAlpha',.5)%plot 3wp inh
title('3wk MEC3 Inh to CA1');
%rlim([0 0.8])
subplot(2,2,4); %8w
polarscatter(i_M3mu2CA1_8wc+pi,i_M3r2CA1_8wc,40,'MarkerFaceColor','b','MarkerFaceAlpha',.5)    %plot 8wp inh
hold on
polarscatter(i_M3mu2CA1_8wp+pi,i_M3r2CA1_8wp,40,'MarkerFaceColor','r','MarkerFaceAlpha',.5)   %plot 8wp inh
title('8wk MEC3 Inh to CA1');
%rlim([0 0.8])
saveas(gca, fullfile(savepath, 'MEC3 Units to CA1 theta phase locking'), 'png');


savepath = 'L:\Susie\SummerEphysHPCEC\AnalysisOutput\HPCEC_analysis\singleunit_phaseloc\MECunits\theta\MEC32MECII\';
if exist(savepath)==0
     mkdir(savepath);
end
figure('Renderer', 'painters', 'Position', [10 10 1500 1000])

%figure(505); %MEC3 2 MECII
subplot(2,2,1); %3w
polarscatter(e_M3mu2MEC_3wc+pi, e_M3r2MEC_3wc,40,'MarkerFaceColor','b','MarkerFaceAlpha',.35)  %plot 3wc exc
hold on
polarscatter(e_M3mu2MEC_3wp+pi,e_M3r2MEC_3wp,40,'MarkerFaceColor','m','MarkerFaceAlpha',.5)%plot 3wp exc
title('3w MEC3 Exc to MECII');
%rlim([0 0.8])
subplot(2,2,2); %8w
polarscatter(e_M3mu2MEC_8wc+pi,e_M3r2MEC_8wc,40,'MarkerFaceColor','b','MarkerFaceAlpha',.5)    %plot 8wp exc
hold on
polarscatter(e_M3mu2MEC_8wp+pi,e_M3r2MEC_8wp,40,'MarkerFaceColor','r','MarkerFaceAlpha',.5)   %plot 8wp exc
title('8w MEC3 Exc to MECII');
%rlim([0 0.8])
subplot(2,2,3); %3w
polarscatter(i_M3mu2MEC_3wc+pi, i_M3r2MEC_3wc,40,'MarkerFaceColor','b','MarkerFaceAlpha',.35)  %plot 3wc inh
hold on
polarscatter(i_M3mu2MEC_3wp+pi,i_M3r2MEC_3wp,40,'MarkerFaceColor','m','MarkerFaceAlpha',.5)%plot 3wp inh
title('3wk MEC3 Inh to MECII');
%rlim([0 0.8])
subplot(2,2,4); %8w
polarscatter(i_M3mu2MEC_8wc+pi,i_M3r2MEC_8wc,40,'MarkerFaceColor','b','MarkerFaceAlpha',.5)   %plot 8wc inh
hold on
polarscatter(i_M3mu2MEC_8wp+pi,i_M3r2MEC_8wp,40,'MarkerFaceColor','r','MarkerFaceAlpha',.5)     %plot 8wp exc
title('8wk MEC3 Inh to MECII');
%rlim([0 0.8])
saveas(gca, fullfile(savepath, 'MEC3 Units to MECII theta phase locking'), 'png');


% savepath = 'L:\Susie\SummerEphysHPCEC\AnalysisOutput\HPCEC_analysis\singleunit_phaseloc\MECunits\theta\MEC12DG\';
% if exist(savepath)==0
%      mkdir(savepath);
% end
% figure('Renderer', 'painters', 'Position', [10 10 1500 1000])
% %figure(506); %MEC1 2 DG
% subplot(2,2,1); %3w
% polarscatter(e_M1mu2DG_3wc+pi, e_M1r2DG_3wc,40,'MarkerFaceColor','b','MarkerFaceAlpha',.35)  %plot 3wc exc
% hold on
% polarscatter(e_M1mu2DG_3wp+pi,e_M1r2DG_3wp,40,'MarkerFaceColor','m','MarkerFaceAlpha',.5)%plot 3wp exc
% title('3wk MEC1 Exc to DG');
% %rlim([0 0.8])
% subplot(2,2,2); %8w
% polarscatter(e_M1mu2DG_8wc+pi,e_M1r2DG_8wc,40,'MarkerFaceColor','b','MarkerFaceAlpha',.5)    %plot 8wp exc
% hold on
% polarscatter(e_M1mu2DG_8wp+pi,e_M1r2DG_8wp,40,'MarkerFaceColor','r','MarkerFaceAlpha',.5)   %plot 8wp exc
% title('8wk MEC1 Exc to DG');
% %rlim([0 0.8])
% subplot(2,2,3); %3w
% polarscatter(i_M1mu2DG_3wc+pi, i_M1r2DG_3wc,40,'MarkerFaceColor','b','MarkerFaceAlpha',.35)  %plot 3wc inh
% hold on
% polarscatter(i_M1mu2DG_3wp+pi,i_M1r2DG_3wp,40,'MarkerFaceColor','m','MarkerFaceAlpha',.5)%plot 3wp inh
% title('3wk MEC1 Inh to DG');
% %rlim([0 0.8])
% subplot(2,2,4); %8w
% polarscatter(i_M1mu2DG_8wc+pi,i_M1r2DG_8wc,40,'MarkerFaceColor','b','MarkerFaceAlpha',.5)    %plot 8wp inh
% hold on
% polarscatter(i_M1mu2DG_8wp+pi,i_M1r2DG_8wp,40,'MarkerFaceColor','r','MarkerFaceAlpha',.5)   %plot 8wp inh
% title('8wk MEC1 Inh to DG');
% %rlim([0 0.8])
% saveas(gca, fullfile(savepath, 'MEC1 Units to DG theta phase locking'), 'png');
% 

savepath = 'L:\Susie\SummerEphysHPCEC\AnalysisOutput\HPCEC_analysis\singleunit_phaseloc\MECunits\theta\MEC22DG\';
if exist(savepath)==0
     mkdir(savepath);
end
figure('Renderer', 'painters', 'Position', [10 10 1500 1000])

%figure(507); %MEC2 2 DG
subplot(2,2,1); %3w
polarscatter(e_M2mu2DG_3wc+pi, e_M2r2DG_3wc,40,'MarkerFaceColor','b','MarkerFaceAlpha',.35)  %plot 3wc exc
hold on
polarscatter(e_M2mu2DG_3wp+pi,e_M2r2DG_3wp,40,'MarkerFaceColor','m','MarkerFaceAlpha',.5)%plot 3wp exc
title('3wk MEC2 Exc to DG');
%rlim([0 0.8])
subplot(2,2,2); %8w
polarscatter(e_M2mu2DG_8wc+pi,e_M2r2DG_8wc,40,'MarkerFaceColor','b','MarkerFaceAlpha',.5)    %plot 8wp exc
hold on
polarscatter(e_M2mu2DG_8wp+pi,e_M2r2DG_8wp,40,'MarkerFaceColor','r','MarkerFaceAlpha',.5)   %plot 8wp exc
title('8wk MEC2 Exc to DG');
%rlim([0 0.8])
subplot(2,2,3); %3w
polarscatter(i_M2mu2DG_3wc+pi, i_M2r2DG_3wc,40,'MarkerFaceColor','b','MarkerFaceAlpha',.35)  %plot 3wc inh
hold on
polarscatter(i_M2mu2DG_3wp+pi,i_M2r2DG_3wp,40,'MarkerFaceColor','m','MarkerFaceAlpha',.5)%plot 3wp inh
title('3wk MEC2 Inh to DG');
%rlim([0 0.8])
subplot(2,2,4); %8w
polarscatter(i_M2mu2DG_8wc+pi,i_M2r2DG_8wc,40,'MarkerFaceColor','b','MarkerFaceAlpha',.5)    %plot 8wp inh
hold on
polarscatter(i_M2mu2DG_8wp+pi,i_M2r2DG_8wp,40,'MarkerFaceColor','r','MarkerFaceAlpha',.5)   %plot 8wp inh
title('8wk MEC2 Inh to DG');
%rlim([0 0.8])
saveas(gca, fullfile(savepath, 'MEC2 Units to DG theta phase locking'), 'png');

savepath = 'L:\Susie\SummerEphysHPCEC\AnalysisOutput\HPCEC_analysis\singleunit_phaseloc\MECunits\theta\MEC32DG\';
if exist(savepath)==0
     mkdir(savepath);
end
figure('Renderer', 'painters', 'Position', [10 10 1500 1000])

%figure(508); %MEC3 2 DG
subplot(2,2,1); %3w
polarscatter(e_M3mu2DG_3wc+pi, e_M3r2DG_3wc,40,'MarkerFaceColor','b','MarkerFaceAlpha',.35)  %plot 3wc exc
hold on
polarscatter(e_M3mu2DG_3wp+pi,e_M3r2DG_3wp,40,'MarkerFaceColor','m','MarkerFaceAlpha',.5)%plot 3wp exc
title('3wk MEC3 Exc to DG');
%rlim([0 0.8])
subplot(2,2,2); %8w
polarscatter(e_M3mu2DG_8wc+pi,e_M3r2DG_8wc,40,'MarkerFaceColor','b','MarkerFaceAlpha',.5)    %plot 8wp exc
hold on
polarscatter(e_M3mu2DG_8wp+pi,e_M3r2DG_8wp,40,'MarkerFaceColor','r','MarkerFaceAlpha',.5)   %plot 8wp exc
title('8wk MEC3 Exc to DG');
%rlim([0 0.8])
subplot(2,2,3); %3w
polarscatter(i_M3mu2DG_3wc+pi, i_M3r2DG_3wc,40,'MarkerFaceColor','b','MarkerFaceAlpha',.35)  %plot 3wc inh
hold on
polarscatter(i_M3mu2DG_3wp+pi,i_M3r2DG_3wp,40,'MarkerFaceColor','m','MarkerFaceAlpha',.5)%plot 3wp inh
title('3wk MEC3 Inh to DG');
%rlim([0 0.8])
subplot(2,2,4); %8w
polarscatter(i_M3mu2DG_8wc+pi,i_M3r2DG_8wc,40,'MarkerFaceColor','b','MarkerFaceAlpha',.5)    %plot 8wp inh
hold on
polarscatter(i_M3mu2DG_8wp+pi,i_M3r2DG_8wp,40,'MarkerFaceColor','r','MarkerFaceAlpha',.5)   %plot 8wp inh
title('8wk MEC3 Inh to DG');
%rlim([0 0.8])
saveas(gca, fullfile(savepath, 'MEC3 Units to DG theta phase locking'), 'png');



%% Plot scatter mu plot with conbined control combined
% Plot scatter mu plot with control combined and r non significant unit excluded
% Plot r with control combined
% ALL expoted as svg
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% read in r-circ p val
% already read in a pval2CA1 pval2DG pval2MEC


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% combine control group r and mu 
i_M1r2MEC_c = [i_M1r2MEC_3wc i_M1r2MEC_8wc];
i_M1r2DG_c = [i_M1r2DG_3wc i_M1r2DG_8wc];
i_M1r2CA1_c = [i_M1r2CA1_3wc i_M1r2CA1_8wc];
i_M1mu2MEC_c = [i_M1mu2MEC_3wc i_M1mu2MEC_8wc];
i_M1mu2DG_c = [i_M1mu2DG_3wc i_M1mu2DG_8wc];
i_M1mu2CA1_c = [i_M1mu2CA1_3wc i_M1mu2CA1_8wc];

e_M1r2MEC_c = [e_M1r2MEC_3wc e_M1r2MEC_8wc];
e_M1r2DG_c = [e_M1r2DG_3wc e_M1r2DG_8wc];
e_M1r2CA1_c = [e_M1r2CA1_3wc e_M1r2CA1_8wc];
e_M1mu2MEC_c = [e_M1mu2MEC_3wc e_M1mu2MEC_8wc];
e_M1mu2DG_c = [e_M1mu2DG_3wc e_M1mu2DG_8wc];
e_M1mu2CA1_c = [e_M1mu2CA1_3wc e_M1mu2CA1_8wc];


i_M2r2MEC_c = [i_M2r2MEC_3wc i_M2r2MEC_8wc];
i_M2r2DG_c = [i_M2r2DG_3wc i_M2r2DG_8wc];
i_M2r2CA1_c = [i_M2r2CA1_3wc i_M2r2CA1_8wc];
i_M2mu2MEC_c = [i_M2mu2MEC_3wc i_M2mu2MEC_8wc];
i_M2mu2DG_c = [i_M2mu2DG_3wc i_M2mu2DG_8wc];
i_M2mu2CA1_c = [i_M2mu2CA1_3wc i_M2mu2CA1_8wc];

e_M2r2MEC_c = [e_M2r2MEC_3wc e_M2r2MEC_8wc];
e_M2r2DG_c = [e_M2r2DG_3wc e_M2r2DG_8wc];
e_M2r2CA1_c = [e_M2r2CA1_3wc e_M2r2CA1_8wc];
e_M2mu2MEC_c = [e_M2mu2MEC_3wc e_M2mu2MEC_8wc];
e_M2mu2DG_c = [e_M2mu2DG_3wc e_M2mu2DG_8wc];
e_M2mu2CA1_c = [e_M2mu2CA1_3wc e_M2mu2CA1_8wc];


i_M3r2MEC_c = [i_M3r2MEC_3wc i_M3r2MEC_8wc];
i_M3r2DG_c = [i_M3r2DG_3wc i_M3r2DG_8wc];
i_M3r2CA1_c = [i_M3r2CA1_3wc i_M3r2CA1_8wc];
i_M3mu2MEC_c = [i_M3mu2MEC_3wc i_M3mu2MEC_8wc];
i_M3mu2DG_c = [i_M3mu2DG_3wc i_M3mu2DG_8wc];
i_M3mu2CA1_c = [i_M3mu2CA1_3wc i_M3mu2CA1_8wc];

e_M3r2MEC_c = [e_M3r2MEC_3wc e_M3r2MEC_8wc];
e_M3r2DG_c = [e_M3r2DG_3wc e_M3r2DG_8wc];
e_M3r2CA1_c = [e_M3r2CA1_3wc e_M3r2CA1_8wc];
e_M3mu2MEC_c = [e_M3mu2MEC_3wc e_M3mu2MEC_8wc];
e_M3mu2DG_c = [e_M3mu2DG_3wc e_M3mu2DG_8wc];
e_M3mu2CA1_c = [e_M3mu2CA1_3wc e_M3mu2CA1_8wc];

%circ r pval
e_M12MECpval_c = [e_M12MECpval_3wc e_M12MECpval_8wc];
e_M12DGpval_c = [e_M12DGpval_3wc e_M12DGpval_8wc];
e_M12CA1pval_c = [e_M12CA1pval_3wc e_M12CA1pval_8wc];
i_M12MECpval_c = [i_M12MECpval_3wc i_M12MECpval_8wc];
i_M12DGpval_c = [i_M12DGpval_3wc i_M12DGpval_8wc];
i_M12CA1pval_c = [i_M12CA1pval_3wc i_M12CA1pval_8wc];

e_M22MECpval_c = [e_M22MECpval_3wc e_M22MECpval_8wc];
e_M22DGpval_c = [e_M22DGpval_3wc e_M22DGpval_8wc];
e_M22CA1pval_c = [e_M22CA1pval_3wc e_M22CA1pval_8wc];
i_M22MECpval_c = [i_M22MECpval_3wc i_M22MECpval_8wc];
i_M22DGpval_c = [i_M22DGpval_3wc i_M22DGpval_8wc];
i_M22CA1pval_c = [i_M22CA1pval_3wc i_M22CA1pval_8wc];

e_M32MECpval_c = [e_M32MECpval_3wc e_M32MECpval_8wc];
e_M32DGpval_c = [e_M32DGpval_3wc e_M32DGpval_8wc];
e_M32CA1pval_c = [e_M32CA1pval_3wc e_M32CA1pval_8wc];
i_M32MECpval_c = [i_M32MECpval_3wc i_M32MECpval_8wc];
i_M32DGpval_c = [i_M32DGpval_3wc i_M32DGpval_8wc];
i_M32CA1pval_c = [i_M32CA1pval_3wc i_M32CA1pval_8wc];

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% take out units in mu list that have non-significant r-circ p val (generate new list, don't overwrite)
%control
i_M1mu2MEC_c_clean = i_M1mu2MEC_c(find(i_M12MECpval_c<0.05));
i_M1mu2DG_c_clean = i_M1mu2DG_c(find(i_M12DGpval_c<0.05));
i_M1mu2CA1_c_clean = i_M1mu2CA1_c(find(i_M12CA1pval_c<0.05));
e_M1mu2MEC_c_clean = e_M1mu2MEC_c(find(e_M12MECpval_c<0.05));
e_M1mu2DG_c_clean = e_M1mu2DG_c(find(e_M12DGpval_c<0.05));
e_M1mu2CA1_c_clean = e_M1mu2CA1_c(find(e_M12CA1pval_c<0.05));

i_M2mu2MEC_c_clean = i_M2mu2MEC_c(find(i_M22MECpval_c<0.05));
i_M2mu2DG_c_clean = i_M2mu2DG_c(find(i_M22DGpval_c<0.05));
i_M2mu2CA1_c_clean = i_M2mu2CA1_c(find(i_M22CA1pval_c<0.05));
e_M2mu2MEC_c_clean = e_M2mu2MEC_c(find(e_M22MECpval_c<0.05));
e_M2mu2DG_c_clean = e_M2mu2DG_c(find(e_M22DGpval_c<0.05));
e_M2mu2CA1_c_clean = e_M2mu2CA1_c(find(e_M22CA1pval_c<0.05));

i_M3mu2MEC_c_clean = i_M3mu2MEC_c(find(i_M32MECpval_c<0.05));
i_M3mu2DG_c_clean = i_M3mu2DG_c(find(i_M32DGpval_c<0.05));
i_M3mu2CA1_c_clean = i_M3mu2CA1_c(find(i_M32CA1pval_c<0.05));
e_M3mu2MEC_c_clean = e_M3mu2MEC_c(find(e_M32MECpval_c<0.05));
e_M3mu2DG_c_clean = e_M3mu2DG_c(find(e_M32DGpval_c<0.05));
e_M3mu2CA1_c_clean = e_M3mu2CA1_c(find(e_M32CA1pval_c<0.05));

%3wp
i_M1mu2MEC_3wp_clean = i_M1mu2MEC_3wp(find(i_M12MECpval_3wp<0.05));
i_M1mu2DG_3wp_clean = i_M1mu2DG_3wp(find(i_M12DGpval_3wp<0.05));
i_M1mu2CA1_3wp_clean = i_M1mu2CA1_3wp(find(i_M12CA1pval_3wp<0.05));
e_M1mu2MEC_3wp_clean = e_M1mu2MEC_3wp(find(e_M12MECpval_3wp<0.05));
e_M1mu2DG_3wp_clean = e_M1mu2DG_3wp(find(e_M12DGpval_3wp<0.05));
e_M1mu2CA1_3wp_clean = e_M1mu2CA1_3wp(find(e_M12CA1pval_3wp<0.05));

i_M2mu2MEC_3wp_clean = i_M2mu2MEC_3wp(find(i_M22MECpval_3wp<0.05));
i_M2mu2DG_3wp_clean = i_M2mu2DG_3wp(find(i_M22DGpval_3wp<0.05));
i_M2mu2CA1_3wp_clean = i_M2mu2CA1_3wp(find(i_M22CA1pval_3wp<0.05));
e_M2mu2MEC_3wp_clean = e_M2mu2MEC_3wp(find(e_M22MECpval_3wp<0.05));
e_M2mu2DG_3wp_clean = e_M2mu2DG_3wp(find(e_M22DGpval_3wp<0.05));
e_M2mu2CA1_3wp_clean = e_M2mu2CA1_3wp(find(e_M22CA1pval_3wp<0.05));

i_M3mu2MEC_3wp_clean = i_M3mu2MEC_3wp(find(i_M32MECpval_3wp<0.05));
i_M3mu2DG_3wp_clean = i_M3mu2DG_3wp(find(i_M32DGpval_3wp<0.05));
i_M3mu2CA1_3wp_clean = i_M3mu2CA1_3wp(find(i_M32CA1pval_3wp<0.05));
e_M3mu2MEC_3wp_clean = e_M3mu2MEC_3wp(find(e_M32MECpval_3wp<0.05));
e_M3mu2DG_3wp_clean = e_M3mu2DG_3wp(find(e_M32DGpval_3wp<0.05));
e_M3mu2CA1_3wp_clean = e_M3mu2CA1_3wp(find(e_M32CA1pval_3wp<0.05));

%8wp
i_M1mu2MEC_8wp_clean = i_M1mu2MEC_8wp(find(i_M12MECpval_8wp<0.05));
i_M1mu2DG_8wp_clean = i_M1mu2DG_8wp(find(i_M12DGpval_8wp<0.05));
i_M1mu2CA1_8wp_clean = i_M1mu2CA1_8wp(find(i_M12CA1pval_8wp<0.05));
e_M1mu2MEC_8wp_clean = e_M1mu2MEC_8wp(find(e_M12MECpval_8wp<0.05));
e_M1mu2DG_8wp_clean = e_M1mu2DG_8wp(find(e_M12DGpval_8wp<0.05));
e_M1mu2CA1_8wp_clean = e_M1mu2CA1_8wp(find(e_M12CA1pval_8wp<0.05));

i_M2mu2MEC_8wp_clean = i_M2mu2MEC_8wp(find(i_M22MECpval_8wp<0.05));
i_M2mu2DG_8wp_clean = i_M2mu2DG_8wp(find(i_M22DGpval_8wp<0.05));
i_M2mu2CA1_8wp_clean = i_M2mu2CA1_8wp(find(i_M22CA1pval_8wp<0.05));
e_M2mu2MEC_8wp_clean = e_M2mu2MEC_8wp(find(e_M22MECpval_8wp<0.05));
e_M2mu2DG_8wp_clean = e_M2mu2DG_8wp(find(e_M22DGpval_8wp<0.05));
e_M2mu2CA1_8wp_clean = e_M2mu2CA1_8wp(find(e_M22CA1pval_8wp<0.05));

i_M3mu2MEC_8wp_clean = i_M3mu2MEC_8wp(find(i_M32MECpval_8wp<0.05));
i_M3mu2DG_8wp_clean = i_M3mu2DG_8wp(find(i_M32DGpval_8wp<0.05));
i_M3mu2CA1_8wp_clean = i_M3mu2CA1_8wp(find(i_M32CA1pval_8wp<0.05));
e_M3mu2MEC_8wp_clean = e_M3mu2MEC_8wp(find(e_M32MECpval_8wp<0.05));
e_M3mu2DG_8wp_clean = e_M3mu2DG_8wp(find(e_M32DGpval_8wp<0.05));
e_M3mu2CA1_8wp_clean = e_M3mu2CA1_8wp(find(e_M32CA1pval_8wp<0.05));


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% plot scatter plot with 3wp 8wp control in one

titlelist_mu = {};
pvallist_mu = [];
titlelist_r = {};
pvallist_r = [];

%%
% %%%%%%%%%%%%%%%%% MU %%%%%%%%%%%%%%%%%%%%%
% %%%%%%%%%%%%%%%%% M1 2 MEC %%%%%%%%%%%%%%%
% savepath='L:\Susie\SummerEphysHPCEC\AnalysisOutput\HPCEC_analysis\singleunit_phaselocc\MECunits\theta\combinedcontrol\M12MEC\';
% if exist(savepath)==0
%      mkdir(savepath);
% end
% 
% i_M1mu2MEC_c_clean_double = [rad2deg(i_M1mu2MEC_c_clean)+180 rad2deg(i_M1mu2MEC_c_clean) + 540];
% i_M1mu2MEC_3wp_clean_double = [rad2deg(i_M1mu2MEC_3wp_clean)+180 rad2deg(i_M1mu2MEC_3wp_clean) + 540];
% i_M1mu2MEC_8wp_clean_double = [rad2deg(i_M1mu2MEC_8wp_clean)+180 rad2deg(i_M1mu2MEC_8wp_clean) + 540];
% e_M1mu2MEC_c_clean_double = [rad2deg(e_M1mu2MEC_c_clean)+180 rad2deg(e_M1mu2MEC_c_clean) + 540];
% e_M1mu2MEC_3wp_clean_double = [rad2deg(e_M1mu2MEC_3wp_clean)+180 rad2deg(e_M1mu2MEC_3wp_clean) + 540];
% e_M1mu2MEC_8wp_clean_double = [rad2deg(e_M1mu2MEC_8wp_clean)+180 rad2deg(e_M1mu2MEC_8wp_clean) + 540];
% 
% %3w mu inh   
% data = {i_M1mu2MEC_c_clean_double, i_M1mu2MEC_3wp_clean_double, i_M1mu2MEC_8wp_clean_double}; %data use for plot
% data_mu_stats = {i_M1mu2MEC_c_clean, i_M1mu2MEC_3wp_clean, i_M1mu2MEC_8wp_clean}; %data use for stats
% title_name = 'Mu Value of M1 Inh to MECII Theta';
% scatterdouble_mu_SF(data, {'Control', '3wp', '8wp'}, {'blue', 'm','red'}, title_name, savepath);
% 
% [pval, k, K] = circ_kuipertest(data_mu_stats{1},data_mu_stats{2});
% [pval_k, f] = circ_ktest(data_mu_stats{1},data_mu_stats{2});
% [pval_w, t] = circ_wwtest(data_mu_stats{1},data_mu_stats{2});
% stats_name = 'Mu of M1 Inh 2 MECII (C vs 3wp)';
% titlelist_mu(1,1) = {convertCharsToStrings(stats_name)};
% pvallist_mu(1,1) = pval;
% pvallist_mu(1,2) = pval_k;
% pvallist_mu(1,3) = pval_w;
% 
% [pval, k, K] = circ_kuipertest(data_mu_stats{1},data_mu_stats{3});
% [pval_k, f] = circ_ktest(data_mu_stats{1},data_mu_stats{3});
% [pval_w, t] = circ_wwtest(data_mu_stats{1},data_mu_stats{3});
% stats_name = 'Mu of M1 Inh 2 MECII (C vs 8wp)';
% titlelist_mu(2,1) = {convertCharsToStrings(stats_name)};
% pvallist_mu(2,1) = pval;
% pvallist_mu(2,2) = pval_k;
% pvallist_mu(2,3) = pval_w;
% 
% [pval, k, K] = circ_kuipertest(data_mu_stats{2},data_mu_stats{3});
% [pval_k, f] = circ_ktest(data_mu_stats{2},data_mu_stats{3});
% [pval_w, t] = circ_wwtest(data_mu_stats{2},data_mu_stats{3});
% stats_name = 'Mu of M1 Inh 2 MECII (3wp vs 8wp)';
% titlelist_mu(3,1) = {convertCharsToStrings(stats_name)};
% pvallist_mu(3,1) = pval;
% pvallist_mu(3,2) = pval_k;
% pvallist_mu(3,3) = pval_w;
% 
% %3w mu Exc   
% data = {e_M1mu2MEC_c_clean_double, e_M1mu2MEC_3wp_clean_double, e_M1mu2MEC_8wp_clean_double}; %data use for plot
% data_mu_stats = {e_M1mu2MEC_c_clean, e_M1mu2MEC_3wp_clean, e_M1mu2MEC_8wp_clean}; %data use for stats
% title_name = 'Mu Value of M1 Exc to MECII Theta';
% scatterdouble_mu_SF(data, {'Control', '3wp', '8wp'}, {'blue', 'm','red'}, title_name, savepath);
% 
% [pval, k, K] = circ_kuipertest(data_mu_stats{1},data_mu_stats{2});
% [pval_k, f] = circ_ktest(data_mu_stats{1},data_mu_stats{2});
% [pval_w, t] = circ_wwtest(data_mu_stats{1},data_mu_stats{2});
% stats_name = 'Mu of M1 Exc 2 MECII (C vs 3wp)';
% titlelist_mu(4,1) = {convertCharsToStrings(stats_name)};
% pvallist_mu(4,1) = pval;
% pvallist_mu(4,2) = pval_k;
% pvallist_mu(4,3) = pval_w;
% 
% [pval, k, K] = circ_kuipertest(data_mu_stats{1},data_mu_stats{3});
% [pval_k, f] = circ_ktest(data_mu_stats{1},data_mu_stats{3});
% [pval_w, t] = circ_wwtest(data_mu_stats{1},data_mu_stats{3});
% stats_name = 'Mu of M1 Exc 2 MECII (C vs 8wp)';
% titlelist_mu(5,1) = {convertCharsToStrings(stats_name)};
% pvallist_mu(5,1) = pval;
% pvallist_mu(5,2) = pval_k;
% pvallist_mu(5,3) = pval_w;
% 
% [pval, k, K] = circ_kuipertest(data_mu_stats{2},data_mu_stats{3});
% [pval_k, f] = circ_ktest(data_mu_stats{2},data_mu_stats{3});
% [pval_w, t] = circ_wwtest(data_mu_stats{2},data_mu_stats{3});
% stats_name = 'Mu of M1 Exc 2 MECII (3wp vs 8wp)';
% titlelist_mu(6,1) = {convertCharsToStrings(stats_name)};
% pvallist_mu(6,1) = pval;
% pvallist_mu(6,2) = pval_k;
% pvallist_mu(6,3) = pval_w;
% 
% %%%%%%%%%%%%%%%%% M1 2 DG %%%%%%%%%%%%%%%
% savepath='L:\Susie\SummerEphysHPCEC\AnalysisOutput\HPCEC_analysis\singleunit_phaseloc\MECunits\theta\combinedcontrol\M12DG\';
% if exist(savepath)==0
%      mkdir(savepath);
% end
% 
% i_M1mu2DG_c_clean_double = [rad2deg(i_M1mu2DG_c_clean)+180 rad2deg(i_M1mu2DG_c_clean) + 540];
% i_M1mu2DG_3wp_clean_double = [rad2deg(i_M1mu2DG_3wp_clean)+180 rad2deg(i_M1mu2DG_3wp_clean) + 540];
% i_M1mu2DG_8wp_clean_double = [rad2deg(i_M1mu2DG_8wp_clean)+180 rad2deg(i_M1mu2DG_8wp_clean) + 540];
% e_M1mu2DG_c_clean_double = [rad2deg(e_M1mu2DG_c_clean)+180 rad2deg(e_M1mu2DG_c_clean) + 540];
% e_M1mu2DG_3wp_clean_double = [rad2deg(e_M1mu2DG_3wp_clean)+180 rad2deg(e_M1mu2DG_3wp_clean) + 540];
% e_M1mu2DG_8wp_clean_double = [rad2deg(e_M1mu2DG_8wp_clean)+180 rad2deg(e_M1mu2DG_8wp_clean) + 540];
% 
% %3w mu inh   
% data = {i_M1mu2DG_c_clean_double, i_M1mu2DG_3wp_clean_double, i_M1mu2DG_8wp_clean_double}; %data use for plot
% data_mu_stats = {i_M1mu2DG_c_clean, i_M1mu2DG_3wp_clean, i_M1mu2DG_8wp_clean}; %data use for stats
% title_name = 'Mu Value of M1 Inh to DG Theta';
% scatterdouble_mu_SF(data, {'Control', '3wp', '8wp'}, {'blue', 'm','red'}, title_name, savepath);
% 
% [pval, k, K] = circ_kuipertest(data_mu_stats{1},data_mu_stats{2});
% [pval_k, f] = circ_ktest(data_mu_stats{1},data_mu_stats{2});
% [pval_w, t] = circ_wwtest(data_mu_stats{1},data_mu_stats{2});
% stats_name = 'Mu of M1 Inh 2 DG (C vs 3wp)';
% titlelist_mu(7,1) = {convertCharsToStrings(stats_name)};
% pvallist_mu(7,1) = pval;
% pvallist_mu(7,2) = pval_k;
% pvallist_mu(7,3) = pval_w;
% 
% [pval, k, K] = circ_kuipertest(data_mu_stats{1},data_mu_stats{3});
% [pval_k, f] = circ_ktest(data_mu_stats{1},data_mu_stats{3});
% [pval_w, t] = circ_wwtest(data_mu_stats{1},data_mu_stats{3});
% stats_name = 'Mu of M1 Inh 2 DG (C vs 8wp)';
% titlelist_mu(8,1) = {convertCharsToStrings(stats_name)};
% pvallist_mu(8,1) = pval;
% pvallist_mu(8,2) = pval_k;
% pvallist_mu(8,3) = pval_w;
% 
% [pval, k, K] = circ_kuipertest(data_mu_stats{2},data_mu_stats{3});
% [pval_k, f] = circ_ktest(data_mu_stats{2},data_mu_stats{3});
% [pval_w, t] = circ_wwtest(data_mu_stats{2},data_mu_stats{3});
% stats_name = 'Mu of M1 Inh 2 DG (3wp vs 8wp)';
% titlelist_mu(9,1) = {convertCharsToStrings(stats_name)};
% pvallist_mu(9,1) = pval;
% pvallist_mu(9,2) = pval_k;
% pvallist_mu(9,3) = pval_w;
% 
% %3w mu Exc   
% data = {e_M1mu2DG_c_clean_double, e_M1mu2DG_3wp_clean_double, e_M1mu2DG_8wp_clean_double}; %data use for plot
% data_mu_stats = {e_M1mu2DG_c_clean, e_M1mu2DG_3wp_clean, e_M1mu2DG_8wp_clean}; %data use for stats
% title_name = 'Mu Value of M1 Exc to DG Theta';
% scatterdouble_mu_SF(data, {'Control', '3wp', '8wp'}, {'blue', 'm','red'}, title_name, savepath);
% 
% [pval, k, K] = circ_kuipertest(data_mu_stats{1},data_mu_stats{2});
% [pval_k, f] = circ_ktest(data_mu_stats{1},data_mu_stats{2});
% [pval_w, t] = circ_wwtest(data_mu_stats{1},data_mu_stats{2});
% stats_name = 'Mu of M1 Exc 2 DG (C vs 3wp)';
% titlelist_mu(10,1) = {convertCharsToStrings(stats_name)};
% pvallist_mu(10,1) = pval;
% pvallist_mu(10,2) = pval_k;
% pvallist_mu(10,3) = pval_w;
% 
% [pval, k, K] = circ_kuipertest(data_mu_stats{1},data_mu_stats{3});
% [pval_k, f] = circ_ktest(data_mu_stats{1},data_mu_stats{3});
% [pval_w, t] = circ_wwtest(data_mu_stats{1},data_mu_stats{3});
% stats_name = 'Mu of M1 Exc 2 DG (C vs 8wp)';
% titlelist_mu(11,1) = {convertCharsToStrings(stats_name)};
% pvallist_mu(11,1) = pval;
% pvallist_mu(11,2) = pval_k;
% pvallist_mu(11,3) = pval_w;
% 
% [pval, k, K] = circ_kuipertest(data_mu_stats{2},data_mu_stats{3});
% [pval_k, f] = circ_ktest(data_mu_stats{2},data_mu_stats{3});
% [pval_w, t] = circ_wwtest(data_mu_stats{2},data_mu_stats{3});
% stats_name = 'Mu of M1 Exc 2 DG (3wp vs 8wp)';
% titlelist_mu(12,1) = {convertCharsToStrings(stats_name)};
% pvallist_mu(12,1) = pval;
% pvallist_mu(12,2) = pval_k;
% pvallist_mu(12,3) = pval_w;
% 
% %%%%%%%%%%%%%%%%% M1 2 CA1 %%%%%%%%%%%%%%%
% savepath='L:\Susie\SummerEphysHPCEC\AnalysisOutput\HPCEC_analysis\singleunit_phaseloc\MECunits\theta\combinedcontrol\M12CA1\';
% if exist(savepath)==0
%      mkdir(savepath);
% end
% 
% i_M1mu2CA1_c_clean_double = [rad2deg(i_M1mu2CA1_c_clean)+180 rad2deg(i_M1mu2CA1_c_clean) + 540];
% i_M1mu2CA1_3wp_clean_double = [rad2deg(i_M1mu2CA1_3wp_clean)+180 rad2deg(i_M1mu2CA1_3wp_clean) + 540];
% i_M1mu2CA1_8wp_clean_double = [rad2deg(i_M1mu2CA1_8wp_clean)+180 rad2deg(i_M1mu2CA1_8wp_clean) + 540];
% e_M1mu2CA1_c_clean_double = [rad2deg(e_M1mu2CA1_c_clean)+180 rad2deg(e_M1mu2CA1_c_clean) + 540];
% e_M1mu2CA1_3wp_clean_double = [rad2deg(e_M1mu2CA1_3wp_clean)+180 rad2deg(e_M1mu2CA1_3wp_clean) + 540];
% e_M1mu2CA1_8wp_clean_double = [rad2deg(e_M1mu2CA1_8wp_clean)+180 rad2deg(e_M1mu2CA1_8wp_clean) + 540];
% 
% %3w mu inh   
% data = {i_M1mu2CA1_c_clean_double, i_M1mu2CA1_3wp_clean_double, i_M1mu2CA1_8wp_clean_double}; %data use for plot
% data_mu_stats = {i_M1mu2CA1_c_clean, i_M1mu2CA1_3wp_clean, i_M1mu2CA1_8wp_clean}; %data use for stats
% title_name = 'Mu Value of M1 Inh to CA1 Theta';
% scatterdouble_mu_SF(data, {'Control', '3wp', '8wp'}, {'blue', 'm','red'}, title_name, savepath);
% 
% [pval, k, K] = circ_kuipertest(data_mu_stats{1},data_mu_stats{2});
% [pval_k, f] = circ_ktest(data_mu_stats{1},data_mu_stats{2});
% [pval_w, t] = circ_wwtest(data_mu_stats{1},data_mu_stats{2});
% stats_name = 'Mu of M1 Inh 2 CA1 (C vs 3wp)';
% titlelist_mu(13,1) = {convertCharsToStrings(stats_name)};
% pvallist_mu(13,1) = pval;
% pvallist_mu(13,2) = pval_k;
% pvallist_mu(13,3) = pval_w;
% 
% [pval, k, K] = circ_kuipertest(data_mu_stats{1},data_mu_stats{3});
% [pval_k, f] = circ_ktest(data_mu_stats{1},data_mu_stats{3});
% [pval_w, t] = circ_wwtest(data_mu_stats{1},data_mu_stats{3});
% stats_name = 'Mu of M1 Inh 2 CA1 (C vs 8wp)';
% titlelist_mu(14,1) = {convertCharsToStrings(stats_name)};
% pvallist_mu(14,1) = pval;
% pvallist_mu(14,2) = pval_k;
% pvallist_mu(14,3) = pval_w;
% 
% [pval, k, K] = circ_kuipertest(data_mu_stats{2},data_mu_stats{3});
% [pval_k, f] = circ_ktest(data_mu_stats{2},data_mu_stats{3});
% [pval_w, t] = circ_wwtest(data_mu_stats{2},data_mu_stats{3});
% stats_name = 'Mu of M1 Inh 2 CA1 (3wp vs 8wp)';
% titlelist_mu(15,1) = {convertCharsToStrings(stats_name)};
% pvallist_mu(15,1) = pval;
% pvallist_mu(15,2) = pval_k;
% pvallist_mu(15,3) = pval_w;
% 
% %3w mu Exc   
% data = {e_M1mu2CA1_c_clean_double, e_M1mu2CA1_3wp_clean_double, e_M1mu2CA1_8wp_clean_double}; %data use for plot
% data_mu_stats = {e_M1mu2CA1_c_clean, e_M1mu2CA1_3wp_clean, e_M1mu2CA1_8wp_clean}; %data use for stats
% title_name = 'Mu Value of M1 Exc to CA1 Theta';
% scatterdouble_mu_SF(data, {'Control', '3wp', '8wp'}, {'blue', 'm','red'}, title_name, savepath);
% 
% [pval, k, K] = circ_kuipertest(data_mu_stats{1},data_mu_stats{2});
% [pval_k, f] = circ_ktest(data_mu_stats{1},data_mu_stats{2});
% [pval_w, t] = circ_wwtest(data_mu_stats{1},data_mu_stats{2});
% stats_name = 'Mu of M1 Exc 2 CA1 (C vs 3wp)';
% titlelist_mu(16,1) = {convertCharsToStrings(stats_name)};
% pvallist_mu(16,1) = pval;
% pvallist_mu(16,2) = pval_k;
% pvallist_mu(16,3) = pval_w;
% 
% [pval, k, K] = circ_kuipertest(data_mu_stats{1},data_mu_stats{3});
% [pval_k, f] = circ_ktest(data_mu_stats{1},data_mu_stats{3});
% [pval_w, t] = circ_wwtest(data_mu_stats{1},data_mu_stats{3});
% stats_name = 'Mu of M1 Exc 2 CA1 (C vs 8wp)';
% titlelist_mu(17,1) = {convertCharsToStrings(stats_name)};
% pvallist_mu(17,1) = pval;
% pvallist_mu(17,2) = pval_k;
% pvallist_mu(17,3) = pval_w;
% 
% [pval, k, K] = circ_kuipertest(data_mu_stats{2},data_mu_stats{3});
% [pval_k, f] = circ_ktest(data_mu_stats{2},data_mu_stats{3});
% [pval_w, t] = circ_wwtest(data_mu_stats{2},data_mu_stats{3});
% stats_name = 'Mu of M1 Exc 2 CA1 (3wp vs 8wp)';
% titlelist_mu(18,1) = {convertCharsToStrings(stats_name)};
% pvallist_mu(18,1) = pval;
% pvallist_mu(18,2) = pval_k;
% pvallist_mu(18,3) = pval_w;


%%%%%%%%%%%%%%%%% M2 2 MEC %%%%%%%%%%%%%%%
savepath='L:\Susie\SummerEphysHPCEC\AnalysisOutput\HPCEC_analysis\singleunit_phaseloc\MECunits\theta\combinedcontrol\M22MEC\';
if exist(savepath)==0
     mkdir(savepath);
end

i_M2mu2MEC_c_clean_double = [rad2deg(i_M2mu2MEC_c_clean)+180 rad2deg(i_M2mu2MEC_c_clean) + 540];
i_M2mu2MEC_3wp_clean_double = [rad2deg(i_M2mu2MEC_3wp_clean)+180 rad2deg(i_M2mu2MEC_3wp_clean) + 540];
i_M2mu2MEC_8wp_clean_double = [rad2deg(i_M2mu2MEC_8wp_clean)+180 rad2deg(i_M2mu2MEC_8wp_clean) + 540];
e_M2mu2MEC_c_clean_double = [rad2deg(e_M2mu2MEC_c_clean)+180 rad2deg(e_M2mu2MEC_c_clean) + 540];
e_M2mu2MEC_3wp_clean_double = [rad2deg(e_M2mu2MEC_3wp_clean)+180 rad2deg(e_M2mu2MEC_3wp_clean) + 540];
e_M2mu2MEC_8wp_clean_double = [rad2deg(e_M2mu2MEC_8wp_clean)+180 rad2deg(e_M2mu2MEC_8wp_clean) + 540];

% inh   
data = {i_M2mu2MEC_c_clean_double, i_M2mu2MEC_3wp_clean_double, i_M2mu2MEC_8wp_clean_double}; %data use for plot
data_mu_stats = {i_M2mu2MEC_c_clean, i_M2mu2MEC_3wp_clean, i_M2mu2MEC_8wp_clean}; %data use for stats
title_name = 'Mu Value of M2 Inh to MECII Theta';
scatterdouble_mu_SF(data, {'Control', '3wp', '8wp'}, {'blue', 'm','red'}, title_name, savepath);

[pval, k, K] = circ_kuipertest(data_mu_stats{1},data_mu_stats{2});
[pval_k, f] = circ_ktest(data_mu_stats{1},data_mu_stats{2});
[pval_w, t] = circ_wwtest(data_mu_stats{1},data_mu_stats{2});
stats_name = 'Mu of M2 Inh 2 MECII (C vs 3wp)';
titlelist_mu(19,1) = {convertCharsToStrings(stats_name)};
pvallist_mu(19,1) = pval;
pvallist_mu(19,2) = pval_k;
pvallist_mu(19,3) = pval_w;

[pval, k, K] = circ_kuipertest(data_mu_stats{1},data_mu_stats{3});
[pval_k, f] = circ_ktest(data_mu_stats{1},data_mu_stats{3});
[pval_w, t] = circ_wwtest(data_mu_stats{1},data_mu_stats{3});
stats_name = 'Mu of M2 Inh 2 MECII (C vs 8wp)';
titlelist_mu(20,1) = {convertCharsToStrings(stats_name)};
pvallist_mu(20,1) = pval;
pvallist_mu(20,2) = pval_k;
pvallist_mu(20,3) = pval_w;

[pval, k, K] = circ_kuipertest(data_mu_stats{2},data_mu_stats{3});
[pval_k, f] = circ_ktest(data_mu_stats{2},data_mu_stats{3});
[pval_w, t] = circ_wwtest(data_mu_stats{2},data_mu_stats{3});
stats_name = 'Mu of M2 Inh 2 MECII (3wp vs 8wp)';
titlelist_mu(21,1) = {convertCharsToStrings(stats_name)};
pvallist_mu(21,1) = pval;
pvallist_mu(21,2) = pval_k;
pvallist_mu(21,3) = pval_w;

% Exc   
data = {e_M2mu2MEC_c_clean_double, e_M2mu2MEC_3wp_clean_double, e_M2mu2MEC_8wp_clean_double}; %data use for plot
data_mu_stats = {e_M2mu2MEC_c_clean, e_M2mu2MEC_3wp_clean, e_M2mu2MEC_8wp_clean}; %data use for stats
title_name = 'Mu Value of M2 Exc to MECII Theta';
scatterdouble_mu_SF(data, {'Control', '3wp', '8wp'}, {'blue', 'm','red'}, title_name, savepath);

[pval, k, K] = circ_kuipertest(data_mu_stats{1},data_mu_stats{2});
[pval_k, f] = circ_ktest(data_mu_stats{1},data_mu_stats{2});
[pval_w, t] = circ_wwtest(data_mu_stats{1},data_mu_stats{2});
stats_name = 'Mu of M2 Exc 2 MECII (C vs 3wp)';
titlelist_mu(22,1) = {convertCharsToStrings(stats_name)};
pvallist_mu(22,1) = pval;
pvallist_mu(22,2) = pval_k;
pvallist_mu(22,3) = pval_w;

[pval, k, K] = circ_kuipertest(data_mu_stats{1},data_mu_stats{3});
[pval_k, f] = circ_ktest(data_mu_stats{1},data_mu_stats{3});
[pval_w, t] = circ_wwtest(data_mu_stats{1},data_mu_stats{3});
stats_name = 'Mu of M2 Exc 2 MECII (C vs 8wp)';
titlelist_mu(23,1) = {convertCharsToStrings(stats_name)};
pvallist_mu(23,1) = pval;
pvallist_mu(23,2) = pval_k;
pvallist_mu(23,3) = pval_w;

[pval, k, K] = circ_kuipertest(data_mu_stats{2},data_mu_stats{3});
[pval_k, f] = circ_ktest(data_mu_stats{2},data_mu_stats{3});
[pval_w, t] = circ_wwtest(data_mu_stats{2},data_mu_stats{3});
stats_name = 'Mu of M2 Exc 2 MECII (3wp vs 8wp)';
titlelist_mu(24,1) = {convertCharsToStrings(stats_name)};
pvallist_mu(24,1) = pval;
pvallist_mu(24,2) = pval_k;
pvallist_mu(24,3) = pval_w;


%%%%%%%%%%%%%%%%% M2 2 DG %%%%%%%%%%%%%%%
savepath='L:\Susie\SummerEphysHPCEC\AnalysisOutput\HPCEC_analysis\singleunit_phaseloc\MECunits\theta\combinedcontrol\M22DG\';
if exist(savepath)==0
     mkdir(savepath);
end

i_M2mu2DG_c_clean_double = [rad2deg(i_M2mu2DG_c_clean)+180 rad2deg(i_M2mu2DG_c_clean) + 540];
i_M2mu2DG_3wp_clean_double = [rad2deg(i_M2mu2DG_3wp_clean)+180 rad2deg(i_M2mu2DG_3wp_clean) + 540];
i_M2mu2DG_8wp_clean_double = [rad2deg(i_M2mu2DG_8wp_clean)+180 rad2deg(i_M2mu2DG_8wp_clean) + 540];
e_M2mu2DG_c_clean_double = [rad2deg(e_M2mu2DG_c_clean)+180 rad2deg(e_M2mu2DG_c_clean) + 540];
e_M2mu2DG_3wp_clean_double = [rad2deg(e_M2mu2DG_3wp_clean)+180 rad2deg(e_M2mu2DG_3wp_clean) + 540];
e_M2mu2DG_8wp_clean_double = [rad2deg(e_M2mu2DG_8wp_clean)+180 rad2deg(e_M2mu2DG_8wp_clean) + 540];

%3w mu inh   
data = {i_M2mu2DG_c_clean_double, i_M2mu2DG_3wp_clean_double, i_M2mu2DG_8wp_clean_double}; %data use for plot
data_mu_stats = {i_M2mu2DG_c_clean, i_M2mu2DG_3wp_clean, i_M2mu2DG_8wp_clean}; %data use for stats
title_name = 'Mu Value of M2 Inh to DG Theta';
scatterdouble_mu_SF(data, {'Control', '3wp', '8wp'}, {'blue', 'm','red'}, title_name, savepath);

[pval, k, K] = circ_kuipertest(data_mu_stats{1},data_mu_stats{2});
[pval_k, f] = circ_ktest(data_mu_stats{1},data_mu_stats{2});
[pval_w, t] = circ_wwtest(data_mu_stats{1},data_mu_stats{2});
stats_name = 'Mu of M2 Inh 2 DG (C vs 3wp)';
titlelist_mu(25,1) = {convertCharsToStrings(stats_name)};
pvallist_mu(25,1) = pval;
pvallist_mu(25,2) = pval_k;
pvallist_mu(25,3) = pval_w;

[pval, k, K] = circ_kuipertest(data_mu_stats{1},data_mu_stats{3});
[pval_k, f] = circ_ktest(data_mu_stats{1},data_mu_stats{3});
[pval_w, t] = circ_wwtest(data_mu_stats{1},data_mu_stats{3});
stats_name = 'Mu of M2 Inh 2 DG (C vs 8wp)';
titlelist_mu(26,1) = {convertCharsToStrings(stats_name)};
pvallist_mu(26,1) = pval;
pvallist_mu(26,2) = pval_k;
pvallist_mu(26,3) = pval_w;

[pval, k, K] = circ_kuipertest(data_mu_stats{2},data_mu_stats{3});
[pval_k, f] = circ_ktest(data_mu_stats{2},data_mu_stats{3});
[pval_w, t] = circ_wwtest(data_mu_stats{2},data_mu_stats{3});
stats_name = 'Mu of M2 Inh 2 DG (3wp vs 8wp)';
titlelist_mu(27,1) = {convertCharsToStrings(stats_name)};
pvallist_mu(27,1) = pval;
pvallist_mu(27,2) = pval_k;
pvallist_mu(27,3) = pval_w;

%3w mu Exc   
data = {e_M2mu2DG_c_clean_double, e_M2mu2DG_3wp_clean_double, e_M2mu2DG_8wp_clean_double}; %data use for plot
data_mu_stats = {e_M2mu2DG_c_clean, e_M2mu2DG_3wp_clean, e_M2mu2DG_8wp_clean}; %data use for stats
title_name = 'Mu Value of M2 Exc to DG Theta';
scatterdouble_mu_SF(data, {'Control', '3wp', '8wp'}, {'blue', 'm','red'}, title_name, savepath);

[pval, k, K] = circ_kuipertest(data_mu_stats{1},data_mu_stats{2});
[pval_k, f] = circ_ktest(data_mu_stats{1},data_mu_stats{2});
[pval_w, t] = circ_wwtest(data_mu_stats{1},data_mu_stats{2});
stats_name = 'Mu of M2 Exc 2 DG (C vs 3wp)';
titlelist_mu(28,1) = {convertCharsToStrings(stats_name)};
pvallist_mu(28,1) = pval;
pvallist_mu(28,2) = pval_k;
pvallist_mu(28,3) = pval_w;

[pval, k, K] = circ_kuipertest(data_mu_stats{1},data_mu_stats{3});
[pval_k, f] = circ_ktest(data_mu_stats{1},data_mu_stats{3});
[pval_w, t] = circ_wwtest(data_mu_stats{1},data_mu_stats{3});
stats_name = 'Mu of M2 Exc 2 DG (C vs 8wp)';
titlelist_mu(29,1) = {convertCharsToStrings(stats_name)};
pvallist_mu(29,1) = pval;
pvallist_mu(29,2) = pval_k;
pvallist_mu(29,3) = pval_w;

[pval, k, K] = circ_kuipertest(data_mu_stats{2},data_mu_stats{3});
[pval_k, f] = circ_ktest(data_mu_stats{2},data_mu_stats{3});
[pval_w, t] = circ_wwtest(data_mu_stats{2},data_mu_stats{3});
stats_name = 'Mu of M2 Exc 2 DG (3wp vs 8wp)';
titlelist_mu(30,1) = {convertCharsToStrings(stats_name)};
pvallist_mu(30,1) = pval;
pvallist_mu(30,2) =  pval_k;
pvallist_mu(30,3) = pval_w;


%%%%%%%%%%%%%%%%% M2 2 CA1 %%%%%%%%%%%%%%%
savepath='L:\Susie\SummerEphysHPCEC\AnalysisOutput\HPCEC_analysis\singleunit_phaseloc\MECunits\theta\combinedcontrol\M22CA1\';
if exist(savepath)==0
     mkdir(savepath);
end

i_M2mu2CA1_c_clean_double = [rad2deg(i_M2mu2CA1_c_clean)+180 rad2deg(i_M2mu2CA1_c_clean) + 540];
i_M2mu2CA1_3wp_clean_double = [rad2deg(i_M2mu2CA1_3wp_clean)+180 rad2deg(i_M2mu2CA1_3wp_clean) + 540];
i_M2mu2CA1_8wp_clean_double = [rad2deg(i_M2mu2CA1_8wp_clean)+180 rad2deg(i_M2mu2CA1_8wp_clean) + 540];
e_M2mu2CA1_c_clean_double = [rad2deg(e_M2mu2CA1_c_clean)+180 rad2deg(e_M2mu2CA1_c_clean) + 540];
e_M2mu2CA1_3wp_clean_double = [rad2deg(e_M2mu2CA1_3wp_clean)+180 rad2deg(e_M2mu2CA1_3wp_clean) + 540];
e_M2mu2CA1_8wp_clean_double = [rad2deg(e_M2mu2CA1_8wp_clean)+180 rad2deg(e_M2mu2CA1_8wp_clean) + 540];

%3w mu inh   
data = {i_M2mu2CA1_c_clean_double, i_M2mu2CA1_3wp_clean_double, i_M2mu2CA1_8wp_clean_double}; %data use for plot
data_mu_stats = {i_M2mu2CA1_c_clean, i_M2mu2CA1_3wp_clean, i_M2mu2CA1_8wp_clean}; %data use for stats
title_name = 'Mu Value of M2 Inh to CA1 Theta';
scatterdouble_mu_SF(data, {'Control', '3wp', '8wp'}, {'blue', 'm','red'}, title_name, savepath);

[pval, k, K] = circ_kuipertest(data_mu_stats{1},data_mu_stats{2});
[pval_k, f] = circ_ktest(data_mu_stats{1},data_mu_stats{2});
[pval_w, t] = circ_wwtest(data_mu_stats{1},data_mu_stats{2});
stats_name = 'Mu of M2 Inh 2 CA1 (C vs 3wp)';
titlelist_mu(31,1) = {convertCharsToStrings(stats_name)};
pvallist_mu(31,1) = pval;
pvallist_mu(31,2) = pval_k;
pvallist_mu(31,3) = pval_w;

[pval, k, K] = circ_kuipertest(data_mu_stats{1},data_mu_stats{3});
[pval_k, f] = circ_ktest(data_mu_stats{1},data_mu_stats{3});
[pval_w, t] = circ_wwtest(data_mu_stats{1},data_mu_stats{3});
stats_name = 'Mu of M2 Inh 2 CA1 (C vs 8wp)';
titlelist_mu(32,1) = {convertCharsToStrings(stats_name)};
pvallist_mu(32,1) = pval;
pvallist_mu(32,2) = pval_k;
pvallist_mu(32,3) = pval_w;

[pval, k, K] = circ_kuipertest(data_mu_stats{2},data_mu_stats{3});
[pval_k, f] = circ_ktest(data_mu_stats{2},data_mu_stats{3});
[pval_w, t] = circ_wwtest(data_mu_stats{2},data_mu_stats{3});
stats_name = 'Mu of M2 Inh 2 CA1 (3wp vs 8wp)';
titlelist_mu(33,1) = {convertCharsToStrings(stats_name)};
pvallist_mu(33,1) = pval;
pvallist_mu(33,2) = pval_k;
pvallist_mu(33,3) = pval_w;

%3w mu Exc   
data = {e_M2mu2CA1_c_clean_double, e_M2mu2CA1_3wp_clean_double, e_M2mu2CA1_8wp_clean_double}; %data use for plot
data_mu_stats = {e_M2mu2CA1_c_clean, e_M2mu2CA1_3wp_clean, e_M2mu2CA1_8wp_clean}; %data use for stats
title_name = 'Mu Value of M2 Exc to CA1 Theta';
scatterdouble_mu_SF(data, {'Control', '3wp', '8wp'}, {'blue', 'm','red'}, title_name, savepath);

[pval, k, K] = circ_kuipertest(data_mu_stats{1},data_mu_stats{2});
[pval_k, f] = circ_ktest(data_mu_stats{1},data_mu_stats{2});
[pval_w, t] = circ_wwtest(data_mu_stats{1},data_mu_stats{2});
stats_name = 'Mu of M2 Exc 2 CA1 (C vs 3wp)';
titlelist_mu(34,1) = {convertCharsToStrings(stats_name)};
pvallist_mu(34,1) = pval;
pvallist_mu(34,2) = pval_k;
pvallist_mu(34,3) = pval_w;

[pval, k, K] = circ_kuipertest(data_mu_stats{1},data_mu_stats{3});
[pval_k, f] = circ_ktest(data_mu_stats{1},data_mu_stats{3});
[pval_w, t] = circ_wwtest(data_mu_stats{1},data_mu_stats{3});
stats_name = 'Mu of M2 Exc 2 CA1 (C vs 8wp)';
titlelist_mu(35,1) = {convertCharsToStrings(stats_name)};
pvallist_mu(35,1) = pval;
pvallist_mu(35,2) = pval_k;
pvallist_mu(35,3) = pval_w;

[pval, k, K] = circ_kuipertest(data_mu_stats{2},data_mu_stats{3});
[pval_k, f] = circ_ktest(data_mu_stats{2},data_mu_stats{3});
[pval_w, t] = circ_wwtest(data_mu_stats{2},data_mu_stats{3});
stats_name = 'Mu of M2 Exc 2 CA1 (3wp vs 8wp)';
titlelist_mu(36,1) = {convertCharsToStrings(stats_name)};
pvallist_mu(36,1) = pval;
pvallist_mu(36,2) = pval_k;
pvallist_mu(36,3) = pval_w;


%%%%%%%%%%%%%%%%% M3 2 MEC %%%%%%%%%%%%%%%
savepath='L:\Susie\SummerEphysHPCEC\AnalysisOutput\HPCEC_analysis\singleunit_phaseloc\MECunits\theta\combinedcontrol\M32MEC\';
if exist(savepath)==0
     mkdir(savepath);
end

i_M3mu2MEC_c_clean_double = [rad2deg(i_M3mu2MEC_c_clean)+180 rad2deg(i_M3mu2MEC_c_clean) + 540];
i_M3mu2MEC_3wp_clean_double = [rad2deg(i_M3mu2MEC_3wp_clean)+180 rad2deg(i_M3mu2MEC_3wp_clean) + 540];
i_M3mu2MEC_8wp_clean_double = [rad2deg(i_M3mu2MEC_8wp_clean)+180 rad2deg(i_M3mu2MEC_8wp_clean) + 540];
e_M3mu2MEC_c_clean_double = [rad2deg(e_M3mu2MEC_c_clean)+180 rad2deg(e_M3mu2MEC_c_clean) + 540];
e_M3mu2MEC_3wp_clean_double = [rad2deg(e_M3mu2MEC_3wp_clean)+180 rad2deg(e_M3mu2MEC_3wp_clean) + 540];
e_M3mu2MEC_8wp_clean_double = [rad2deg(e_M3mu2MEC_8wp_clean)+180 rad2deg(e_M3mu2MEC_8wp_clean) + 540];

%3w mu inh   
data = {i_M3mu2MEC_c_clean_double, i_M3mu2MEC_3wp_clean_double, i_M3mu2MEC_8wp_clean_double}; %data use for plot
data_mu_stats = {i_M3mu2MEC_c_clean, i_M3mu2MEC_3wp_clean, i_M3mu2MEC_8wp_clean}; %data use for stats
title_name = 'Mu Value of M3 Inh to MECII Theta';
scatterdouble_mu_SF(data, {'Control', '3wp', '8wp'}, {'blue', 'm','red'}, title_name, savepath);

[pval, k, K] = circ_kuipertest(data_mu_stats{1},data_mu_stats{2});
[pval_k, f] = circ_ktest(data_mu_stats{1},data_mu_stats{2});
[pval_w, t] = circ_wwtest(data_mu_stats{1},data_mu_stats{2});
stats_name = 'Mu of M3 Inh 2 MECII (C vs 3wp)';
titlelist_mu(37,1) = {convertCharsToStrings(stats_name)};
pvallist_mu(37,1) = pval;
pvallist_mu(37,2) = pval_k;
pvallist_mu(37,3) = pval_w;

[pval, k, K] = circ_kuipertest(data_mu_stats{1},data_mu_stats{3});
[pval_k, f] = circ_ktest(data_mu_stats{1},data_mu_stats{3});
[pval_w, t] = circ_wwtest(data_mu_stats{1},data_mu_stats{3});
stats_name = 'Mu of M3 Inh 2 MECII (C vs 8wp)';
titlelist_mu(38,1) = {convertCharsToStrings(stats_name)};
pvallist_mu(38,1) = pval;
pvallist_mu(38,2) = pval_k;
pvallist_mu(38,3) = pval_w;

[pval, k, K] = circ_kuipertest(data_mu_stats{2},data_mu_stats{3});
[pval_k, f] = circ_ktest(data_mu_stats{2},data_mu_stats{3});
[pval_w, t] = circ_wwtest(data_mu_stats{2},data_mu_stats{3});
stats_name = 'Mu of M3 Inh 2 MECII (3wp vs 8wp)';
titlelist_mu(39,1) = {convertCharsToStrings(stats_name)};
pvallist_mu(39,1) = pval;
pvallist_mu(39,2) = pval_k;
pvallist_mu(39,3) = pval_w;

%3w mu Exc   
data = {e_M3mu2MEC_c_clean_double, e_M3mu2MEC_3wp_clean_double, e_M3mu2MEC_8wp_clean_double}; %data use for plot
data_mu_stats = {e_M3mu2MEC_c_clean, e_M3mu2MEC_3wp_clean, e_M3mu2MEC_8wp_clean}; %data use for stats
title_name = 'Mu Value of M3 Exc to MECII Theta';
scatterdouble_mu_SF(data, {'Control', '3wp', '8wp'}, {'blue', 'm','red'}, title_name, savepath);

[pval, k, K] = circ_kuipertest(data_mu_stats{1},data_mu_stats{2});
[pval_k, f] = circ_ktest(data_mu_stats{1},data_mu_stats{2});
[pval_w, t] = circ_wwtest(data_mu_stats{1},data_mu_stats{2});
stats_name = 'Mu of M3 Exc 2 MECII (C vs 3wp)';
titlelist_mu(40,1) = {convertCharsToStrings(stats_name)};
pvallist_mu(40,1) = pval;
pvallist_mu(40,2) = pval_k;
pvallist_mu(40,3) = pval_w;

[pval, k, K] = circ_kuipertest(data_mu_stats{1},data_mu_stats{3});
[pval_k, f] = circ_ktest(data_mu_stats{1},data_mu_stats{3});
[pval_w, t] = circ_wwtest(data_mu_stats{1},data_mu_stats{3});
stats_name = 'Mu of M3 Exc 2 MECII (C vs 8wp)';
titlelist_mu(41,1) = {convertCharsToStrings(stats_name)};
pvallist_mu(41,1) = pval;
pvallist_mu(41,2) = pval_k;
pvallist_mu(41,3) = pval_w;

[pval, k, K] = circ_kuipertest(data_mu_stats{2},data_mu_stats{3});
[pval_k, f] = circ_ktest(data_mu_stats{2},data_mu_stats{3});
[pval_w, t] = circ_wwtest(data_mu_stats{2},data_mu_stats{3});
stats_name = 'Mu of M3 Exc 2 MECII (3wp vs 8wp)';
titlelist_mu(42,1) = {convertCharsToStrings(stats_name)};
pvallist_mu(42,1) = pval;
pvallist_mu(42,2) = pval_k;
pvallist_mu(42,3) = pval_w;


%%%%%%%%%%%%%%%%% M3 2 DG %%%%%%%%%%%%%%%
savepath='L:\Susie\SummerEphysHPCEC\AnalysisOutput\HPCEC_analysis\singleunit_phaseloc\MECunits\theta\combinedcontrol\M32DG\';
if exist(savepath)==0
     mkdir(savepath);
end

i_M3mu2DG_c_clean_double = [rad2deg(i_M3mu2DG_c_clean)+180 rad2deg(i_M3mu2DG_c_clean) + 540];
i_M3mu2DG_3wp_clean_double = [rad2deg(i_M3mu2DG_3wp_clean)+180 rad2deg(i_M3mu2DG_3wp_clean) + 540];
i_M3mu2DG_8wp_clean_double = [rad2deg(i_M3mu2DG_8wp_clean)+180 rad2deg(i_M3mu2DG_8wp_clean) + 540];
e_M3mu2DG_c_clean_double = [rad2deg(e_M3mu2DG_c_clean)+180 rad2deg(e_M3mu2DG_c_clean) + 540];
e_M3mu2DG_3wp_clean_double = [rad2deg(e_M3mu2DG_3wp_clean)+180 rad2deg(e_M3mu2DG_3wp_clean) + 540];
e_M3mu2DG_8wp_clean_double = [rad2deg(e_M3mu2DG_8wp_clean)+180 rad2deg(e_M3mu2DG_8wp_clean) + 540];

%3w mu inh   
data = {i_M3mu2DG_c_clean_double, i_M3mu2DG_3wp_clean_double, i_M3mu2DG_8wp_clean_double}; %data use for plot
data_mu_stats = {i_M3mu2DG_c_clean, i_M3mu2DG_3wp_clean, i_M3mu2DG_8wp_clean}; %data use for stats
title_name = 'Mu Value of M3 Inh to DG Theta';
scatterdouble_mu_SF(data, {'Control', '3wp', '8wp'}, {'blue', 'm','red'}, title_name, savepath);

[pval, k, K] = circ_kuipertest(data_mu_stats{1},data_mu_stats{2});
[pval_k, f] = circ_ktest(data_mu_stats{1},data_mu_stats{2});
[pval_w, t] = circ_wwtest(data_mu_stats{1},data_mu_stats{2});
stats_name = 'Mu of M3 Inh 2 DG (C vs 3wp)';
titlelist_mu(43,1) = {convertCharsToStrings(stats_name)};
pvallist_mu(43,1) = pval;
pvallist_mu(43,2) = pval_k;
pvallist_mu(43,3) = pval_w;

[pval, k, K] = circ_kuipertest(data_mu_stats{1},data_mu_stats{3});
[pval_k, f] = circ_ktest(data_mu_stats{1},data_mu_stats{3});
[pval_w, t] = circ_wwtest(data_mu_stats{1},data_mu_stats{3});
stats_name = 'Mu of M3 Inh 2 DG (C vs 8wp)';
titlelist_mu(44,1) = {convertCharsToStrings(stats_name)};
pvallist_mu(44,1) = pval;
pvallist_mu(44,2) = pval_k;
pvallist_mu(44,3) = pval_w;

[pval, k, K] = circ_kuipertest(data_mu_stats{2},data_mu_stats{3});
[pval_k, f] = circ_ktest(data_mu_stats{2},data_mu_stats{3});
[pval_w, t] = circ_wwtest(data_mu_stats{2},data_mu_stats{3});
stats_name = 'Mu of M3 Inh 2 DG (3wp vs 8wp)';
titlelist_mu(45,1) = {convertCharsToStrings(stats_name)};
pvallist_mu(45,1) = pval;
pvallist_mu(45,2) = pval_k;
pvallist_mu(45,3) = pval_w;

%3w mu Exc   
data = {e_M3mu2DG_c_clean_double, e_M3mu2DG_3wp_clean_double, e_M3mu2DG_8wp_clean_double}; %data use for plot
data_mu_stats = {e_M3mu2DG_c_clean, e_M3mu2DG_3wp_clean, e_M3mu2DG_8wp_clean}; %data use for stats
title_name = 'Mu Value of M3 Exc to DG Theta';
scatterdouble_mu_SF(data, {'Control', '3wp', '8wp'}, {'blue', 'm','red'}, title_name, savepath);

[pval, k, K] = circ_kuipertest(data_mu_stats{1},data_mu_stats{2});
[pval_k, f] = circ_ktest(data_mu_stats{1},data_mu_stats{2});
[pval_w, t] = circ_wwtest(data_mu_stats{1},data_mu_stats{2});
stats_name = 'Mu of M3 Exc 2 DG (C vs 3wp)';
titlelist_mu(46,1) = {convertCharsToStrings(stats_name)};
pvallist_mu(46,1) = pval;
pvallist_mu(46,2) = pval_k;
pvallist_mu(46,3) = pval_w;

[pval, k, K] = circ_kuipertest(data_mu_stats{1},data_mu_stats{3});
[pval_k, f] = circ_ktest(data_mu_stats{1},data_mu_stats{3});
[pval_w, t] = circ_wwtest(data_mu_stats{1},data_mu_stats{3});
stats_name = 'Mu of M3 Exc 2 DG (C vs 8wp)';
titlelist_mu(47,1) = {convertCharsToStrings(stats_name)};
pvallist_mu(47,1) = pval;
pvallist_mu(47,2) = pval_k;
pvallist_mu(47,3) = pval_w;

[pval, k, K] = circ_kuipertest(data_mu_stats{2},data_mu_stats{3});
[pval_k, f] = circ_ktest(data_mu_stats{2},data_mu_stats{3});
[pval_w, t] = circ_wwtest(data_mu_stats{2},data_mu_stats{3});
stats_name = 'Mu of M3 Exc 2 DG (3wp vs 8wp)';
titlelist_mu(48,1) = {convertCharsToStrings(stats_name)};
pvallist_mu(48,1) = pval;
pvallist_mu(48,2) =  pval_k;
pvallist_mu(48,3) = pval_w;


%%%%%%%%%%%%%%%%% M3 2 CA1 %%%%%%%%%%%%%%%
savepath='L:\Susie\SummerEphysHPCEC\AnalysisOutput\HPCEC_analysis\singleunit_phaseloc\MECunits\theta\combinedcontrol\M32CA1\';
if exist(savepath)==0
     mkdir(savepath);
end

i_M3mu2CA1_c_clean_double = [rad2deg(i_M3mu2CA1_c_clean)+180 rad2deg(i_M3mu2CA1_c_clean) + 540];
i_M3mu2CA1_3wp_clean_double = [rad2deg(i_M3mu2CA1_3wp_clean)+180 rad2deg(i_M3mu2CA1_3wp_clean) + 540];
i_M3mu2CA1_8wp_clean_double = [rad2deg(i_M3mu2CA1_8wp_clean)+180 rad2deg(i_M3mu2CA1_8wp_clean) + 540];
e_M3mu2CA1_c_clean_double = [rad2deg(e_M3mu2CA1_c_clean)+180 rad2deg(e_M3mu2CA1_c_clean) + 540];
e_M3mu2CA1_3wp_clean_double = [rad2deg(e_M3mu2CA1_3wp_clean)+180 rad2deg(e_M3mu2CA1_3wp_clean) + 540];
e_M3mu2CA1_8wp_clean_double = [rad2deg(e_M3mu2CA1_8wp_clean)+180 rad2deg(e_M3mu2CA1_8wp_clean) + 540];

%3w mu inh   
data = {i_M3mu2CA1_c_clean_double, i_M3mu2CA1_3wp_clean_double, i_M3mu2CA1_8wp_clean_double}; %data use for plot
data_mu_stats = {i_M3mu2CA1_c_clean, i_M3mu2CA1_3wp_clean, i_M3mu2CA1_8wp_clean}; %data use for stats
title_name = 'Mu Value of M3 Inh to CA1 Theta';
scatterdouble_mu_SF(data, {'Control', '3wp', '8wp'}, {'blue', 'm','red'}, title_name, savepath);

[pval, k, K] = circ_kuipertest(data_mu_stats{1},data_mu_stats{2});
[pval_k, f] = circ_ktest(data_mu_stats{1},data_mu_stats{2});
[pval_w, t] = circ_wwtest(data_mu_stats{1},data_mu_stats{2});
stats_name = 'Mu of M3 Inh 2 CA1 (C vs 3wp)';
titlelist_mu(49,1) = {convertCharsToStrings(stats_name)};
pvallist_mu(49,1) = pval;
pvallist_mu(49,2) = pval_k;
pvallist_mu(49,3) = pval_w;

[pval, k, K] = circ_kuipertest(data_mu_stats{1},data_mu_stats{3});
[pval_k, f] = circ_ktest(data_mu_stats{1},data_mu_stats{3});
[pval_w, t] = circ_wwtest(data_mu_stats{1},data_mu_stats{3});
stats_name = 'Mu of M3 Inh 2 CA1 (C vs 8wp)';
titlelist_mu(50,1) = {convertCharsToStrings(stats_name)};
pvallist_mu(50,1) = pval;
pvallist_mu(50,2) = pval_k;
pvallist_mu(50,3) = pval_w;

[pval, k, K] = circ_kuipertest(data_mu_stats{2},data_mu_stats{3});
[pval_k, f] = circ_ktest(data_mu_stats{2},data_mu_stats{3});
[pval_w, t] = circ_wwtest(data_mu_stats{2},data_mu_stats{3});
stats_name = 'Mu of M3 Inh 2 CA1 (3wp vs 8wp)';
titlelist_mu(51,1) = {convertCharsToStrings(stats_name)};
pvallist_mu(51,1) = pval;
pvallist_mu(51,2) = pval_k;
pvallist_mu(51,3) = pval_w;

%3w mu Exc   
data = {e_M3mu2CA1_c_clean_double, e_M3mu2CA1_3wp_clean_double, e_M3mu2CA1_8wp_clean_double}; %data use for plot
data_mu_stats = {e_M3mu2CA1_c_clean, e_M3mu2CA1_3wp_clean, e_M3mu2CA1_8wp_clean}; %data use for stats
title_name = 'Mu Value of M3 Exc to CA1 Theta';
scatterdouble_mu_SF(data, {'Control', '3wp', '8wp'}, {'blue', 'm','red'}, title_name, savepath);

[pval, k, K] = circ_kuipertest(data_mu_stats{1},data_mu_stats{2});
[pval_k, f] = circ_ktest(data_mu_stats{1},data_mu_stats{2});
[pval_w, t] = circ_wwtest(data_mu_stats{1},data_mu_stats{2});
stats_name = 'Mu of M3 Exc 2 CA1 (C vs 3wp)';
titlelist_mu(52,1) = {convertCharsToStrings(stats_name)};
pvallist_mu(52,1) = pval;
pvallist_mu(52,2) = pval_k;
pvallist_mu(52,3) = pval_w;

[pval, k, K] = circ_kuipertest(data_mu_stats{1},data_mu_stats{3});
[pval_k, f] = circ_ktest(data_mu_stats{1},data_mu_stats{3});
[pval_w, t] = circ_wwtest(data_mu_stats{1},data_mu_stats{3});
stats_name = 'Mu of M3 Exc 2 CA1 (C vs 8wp)';
titlelist_mu(53,1) = {convertCharsToStrings(stats_name)};
pvallist_mu(53,1) = pval;
pvallist_mu(53,2) = pval_k;
pvallist_mu(53,3) = pval_w;

[pval, k, K] = circ_kuipertest(data_mu_stats{2},data_mu_stats{3});
[pval_k, f] = circ_ktest(data_mu_stats{2},data_mu_stats{3});
[pval_w, t] = circ_wwtest(data_mu_stats{2},data_mu_stats{3});
stats_name = 'Mu of M3 Exc 2 CA1 (3wp vs 8wp)';
titlelist_mu(54,1) = {convertCharsToStrings(stats_name)};
pvallist_mu(54,1) = pval;
pvallist_mu(54,2) = pval_k;
pvallist_mu(54,3) = pval_w;


%save mu pval table
mu_pvaltable = table(titlelist_mu, pvallist_mu); %write pval to a table
writetable(mu_pvaltable, 'L:\Susie\SummerEphysHPCEC\AnalysisOutput\HPCEC_analysis\singleunit_phaseloc\MECunits\theta\combinedcontrol\mu_pvaltable_MEC.csv','Delimiter',',') %first col: name; second col: pval for kuipertest/Mann-Whitney test; third col: pval for ktest (for centralization). forth col: Wwtest (for equal means) 

%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% r %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%% M1 2 MEC %%%%%%%%%%%%%%%
% savepath='L:\Susie\SummerEphysHPCEC\AnalysisOutput\HPCEC_analysis\singleunit_phaseloc\MECunits\theta\combinedcontrol\M12MEC\';
% if exist(savepath)==0
%      mkdir(savepath);
% end
% % r inh   
% data = {i_M1r2MEC_c, i_M1r2MEC_3wp, i_M1r2MEC_8wp}; %data use for plot and stats
% title_name = 'r Value of M1 Inh to MECII Theta';
% [results] = scatterBars_r_SF(data, {'Control', '3wp', '8wp'}, {'blue', 'm','red'}, title_name, savepath);
% titlelist_r(1,1) = {convertCharsToStrings(title_name)};
% pvallist_r(1,1) = results(1,6); %control vs 3wp
% pvallist_r(1,2) = results(2,6); %control vs 8wp
% pvallist_r(1,3) = results(3,6); %3wp vs 8wp
% % r exc
% data = {e_M1r2MEC_c, e_M1r2MEC_3wp, e_M1r2MEC_8wp}; %data use for plot and stats
% title_name = 'r Value of M1 Exc to MECII Theta';
% [results] = scatterBars_r_SF(data, {'Control', '3wp', '8wp'}, {'blue', 'm','red'}, title_name, savepath);
% titlelist_r(2,1) = {convertCharsToStrings(title_name)};
% pvallist_r(2,1) = results(1,6); %control vs 3wp
% pvallist_r(2,2) = results(2,6); %control vs 8wp
% pvallist_r(2,3) = results(3,6); %3wp vs 8wp


%%%%%%%%%%%%%%%%% M2 2 MEC %%%%%%%%%%%%%%%
savepath='L:\Susie\SummerEphysHPCEC\AnalysisOutput\HPCEC_analysis\singleunit_phaseloc\MECunits\theta\combinedcontrol\M22MEC\';
if exist(savepath)==0
     mkdir(savepath);
end
% r inh   
data = {i_M2r2MEC_c, i_M2r2MEC_3wp, i_M2r2MEC_8wp}; %data use for plot and stats
title_name = 'r Value of M2 Inh to MECII Theta';
[results] = scatterBars_r_SF(data, {'Control', '3wp', '8wp'}, {'blue', 'm','red'}, title_name, savepath);
titlelist_r(3,1) = {convertCharsToStrings(title_name)};
pvallist_r(3,1) = results(1,6); %control vs 3wp
pvallist_r(3,2) = results(2,6); %control vs 8wp
pvallist_r(3,3) = results(3,6); %3wp vs 8wp
% r exc
data = {e_M2r2MEC_c, e_M2r2MEC_3wp, e_M2r2MEC_8wp}; %data use for plot and stats
title_name = 'r Value of M2 Exc to MECII Theta';
[results] = scatterBars_r_SF(data, {'Control', '3wp', '8wp'}, {'blue', 'm','red'}, title_name, savepath);
titlelist_r(4,1) = {convertCharsToStrings(title_name)};
pvallist_r(4,1) = results(1,6); %control vs 3wp
pvallist_r(4,2) = results(2,6); %control vs 8wp
pvallist_r(4,3) = results(3,6); %3wp vs 8wp


%%%%%%%%%%%%%%%%% M3 2 MEC %%%%%%%%%%%%%%%
savepath='L:\Susie\SummerEphysHPCEC\AnalysisOutput\HPCEC_analysis\singleunit_phaseloc\MECunits\theta\combinedcontrol\M32MEC\';
if exist(savepath)==0
     mkdir(savepath);
end
% r inh   
data = {i_M3r2MEC_c, i_M3r2MEC_3wp, i_M3r2MEC_8wp}; %data use for plot and stats
title_name = 'r Value of M3 Inh to MECII Theta';
[results] = scatterBars_r_SF(data, {'Control', '3wp', '8wp'}, {'blue', 'm','red'}, title_name, savepath);
titlelist_r(5,1) = {convertCharsToStrings(title_name)};
pvallist_r(5,1) = results(1,6); %control vs 3wp
pvallist_r(5,2) = results(2,6); %control vs 8wp
pvallist_r(5,3) = results(3,6); %3wp vs 8wp
% r exc
data = {e_M3r2MEC_c, e_M3r2MEC_3wp, e_M3r2MEC_8wp}; %data use for plot and stats
title_name = 'r Value of M3 Exc to MECII Theta';
[results] = scatterBars_r_SF(data, {'Control', '3wp', '8wp'}, {'blue', 'm','red'}, title_name, savepath);
titlelist_r(6,1) = {convertCharsToStrings(title_name)};
pvallist_r(6,1) = results(1,6); %control vs 3wp
pvallist_r(6,2) = results(2,6); %control vs 8wp
pvallist_r(6,3) = results(3,6); %3wp vs 8wp

%%%%%%%%%%%%%%%%% M1 2 DG %%%%%%%%%%%%%%%
% savepath='L:\Susie\SummerEphysHPCEC\AnalysisOutput\HPCEC_analysis\singleunit_phaseloc\MECunits\theta\combinedcontrol\M12DG\';
% if exist(savepath)==0
%      mkdir(savepath);
% end
% % r inh   
% data = {i_M1r2DG_c, i_M1r2DG_3wp, i_M1r2DG_8wp}; %data use for plot and stats
% title_name = 'r Value of M1 Inh to DG Theta';
% [results] = scatterBars_r_SF(data, {'Control', '3wp', '8wp'}, {'blue', 'm','red'}, title_name, savepath);
% titlelist_r(7,1) = {convertCharsToStrings(title_name)};
% pvallist_r(7,1) = results(1,6); %control vs 3wp
% pvallist_r(7,2) = results(2,6); %control vs 8wp
% pvallist_r(7,3) = results(3,6); %3wp vs 8wp
% % r exc
% data = {e_M1r2DG_c, e_M1r2DG_3wp, e_M1r2DG_8wp}; %data use for plot and stats
% title_name = 'r Value of M1 Exc to DG Theta';
% [results] = scatterBars_r_SF(data, {'Control', '3wp', '8wp'}, {'blue', 'm','red'}, title_name, savepath);
% titlelist_r(8,1) = {convertCharsToStrings(title_name)};
% pvallist_r(8,1) = results(1,6); %control vs 3wp
% pvallist_r(8,2) = results(2,6); %control vs 8wp
% pvallist_r(8,3) = results(3,6); %3wp vs 8wp

%%%%%%%%%%%%%%%%% M2 2 DG %%%%%%%%%%%%%%%
savepath='L:\Susie\SummerEphysHPCEC\AnalysisOutput\HPCEC_analysis\singleunit_phaseloc\MECunits\theta\combinedcontrol\M22DG\';
if exist(savepath)==0
     mkdir(savepath);
end
% r inh   
data = {i_M2r2DG_c, i_M2r2DG_3wp, i_M2r2DG_8wp}; %data use for plot and stats
title_name = 'r Value of M2 Inh to DG Theta';
[results] = scatterBars_r_SF(data, {'Control', '3wp', '8wp'}, {'blue', 'm','red'}, title_name, savepath);
titlelist_r(9,1) = {convertCharsToStrings(title_name)};
pvallist_r(9,1) = results(1,6); %control vs 3wp
pvallist_r(9,2) = results(2,6); %control vs 8wp
pvallist_r(9,3) = results(3,6); %3wp vs 8wp
% r exc
data = {e_M2r2DG_c, e_M2r2DG_3wp, e_M2r2DG_8wp}; %data use for plot and stats
title_name = 'r Value of M2 Exc to DG Theta';
[results] = scatterBars_r_SF(data, {'Control', '3wp', '8wp'}, {'blue', 'm','red'}, title_name, savepath);
titlelist_r(10,1) = {convertCharsToStrings(title_name)};
pvallist_r(10,1) = results(1,6); %control vs 3wp
pvallist_r(10,2) = results(2,6); %control vs 8wp
pvallist_r(10,3) = results(3,6); %3wp vs 8wp


%%%%%%%%%%%%%%%%% M3 2 DG %%%%%%%%%%%%%%%
savepath='L:\Susie\SummerEphysHPCEC\AnalysisOutput\HPCEC_analysis\singleunit_phaseloc\MECunits\theta\combinedcontrol\M32DG\';
if exist(savepath)==0
     mkdir(savepath);
end
% r inh   
data = {i_M3r2DG_c, i_M3r2DG_3wp, i_M3r2DG_8wp}; %data use for plot and stats
title_name = 'r Value of M3 Inh to DG Theta';
[results] = scatterBars_r_SF(data, {'Control', '3wp', '8wp'}, {'blue', 'm','red'}, title_name, savepath);
titlelist_r(11,1) = {convertCharsToStrings(title_name)};
pvallist_r(11,1) = results(1,6); %control vs 3wp
pvallist_r(11,2) = results(2,6); %control vs 8wp
pvallist_r(11,3) = results(3,6); %3wp vs 8wp
% r exc
data = {e_M3r2DG_c, e_M3r2DG_3wp, e_M3r2DG_8wp}; %data use for plot and stats
title_name = 'r Value of M3 Exc to DG Theta';
[results] = scatterBars_r_SF(data, {'Control', '3wp', '8wp'}, {'blue', 'm','red'}, title_name, savepath);
titlelist_r(12,1) = {convertCharsToStrings(title_name)};
pvallist_r(12,1) = results(1,6); %control vs 3wp
pvallist_r(12,2) = results(2,6); %control vs 8wp
pvallist_r(12,3) = results(3,6); %3wp vs 8wp


%%%%%%%%%%%%%%%%% M1 2 CA1 %%%%%%%%%%%%%%%
% savepath='L:\Susie\SummerEphysHPCEC\AnalysisOutput\HPCEC_analysis\singleunit_phaseloc\MECunits\theta\combinedcontrol\M12CA1\';
% if exist(savepath)==0
%      mkdir(savepath);
% end
% % r inh   
% data = {i_M1r2CA1_c, i_M1r2CA1_3wp, i_M1r2CA1_8wp}; %data use for plot and stats
% title_name = 'r Value of M1 Inh to CA1II Theta';
% [results] = scatterBars_r_SF(data, {'Control', '3wp', '8wp'}, {'blue', 'm','red'}, title_name, savepath);
% titlelist_r(13,1) = {convertCharsToStrings(title_name)};
% pvallist_r(13,1) = results(1,6); %control vs 3wp
% pvallist_r(13,2) = results(2,6); %control vs 8wp
% pvallist_r(13,3) = results(3,6); %3wp vs 8wp
% % r exc
% data = {e_M1r2CA1_c, e_M1r2CA1_3wp, e_M1r2CA1_8wp}; %data use for plot and stats
% title_name = 'r Value of M1 Exc to CA1II Theta';
% [results] = scatterBars_r_SF(data, {'Control', '3wp', '8wp'}, {'blue', 'm','red'}, title_name, savepath);
% titlelist_r(14,1) = {convertCharsToStrings(title_name)};
% pvallist_r(14,1) = results(1,6); %control vs 3wp
% pvallist_r(14,2) = results(2,6); %control vs 8wp
% pvallist_r(14,3) = results(3,6); %3wp vs 8wp

%%%%%%%%%%%%%%%%% M2 2 CA1 %%%%%%%%%%%%%%%
savepath='L:\Susie\SummerEphysHPCEC\AnalysisOutput\HPCEC_analysis\singleunit_phaseloc\MECunits\theta\combinedcontrol\M22CA1\';
if exist(savepath)==0
     mkdir(savepath);
end
% r inh   
data = {i_M2r2CA1_c, i_M2r2CA1_3wp, i_M2r2CA1_8wp}; %data use for plot and stats
title_name = 'r Value of M2 Inh to CA1 Theta';
[results] = scatterBars_r_SF(data, {'Control', '3wp', '8wp'}, {'blue', 'm','red'}, title_name, savepath);
titlelist_r(15,1) = {convertCharsToStrings(title_name)};
pvallist_r(15,1) = results(1,6); %control vs 3wp
pvallist_r(15,2) = results(2,6); %control vs 8wp
pvallist_r(15,3) = results(3,6); %3wp vs 8wp
% r exc
data = {e_M2r2CA1_c, e_M2r2CA1_3wp, e_M2r2CA1_8wp}; %data use for plot and stats
title_name = 'r Value of M2 Exc to CA1 Theta';
[results] = scatterBars_r_SF(data, {'Control', '3wp', '8wp'}, {'blue', 'm','red'}, title_name, savepath);
titlelist_r(16,1) = {convertCharsToStrings(title_name)};
pvallist_r(16,1) = results(1,6); %control vs 3wp
pvallist_r(16,2) = results(2,6); %control vs 8wp
pvallist_r(16,3) = results(3,6); %3wp vs 8wp


%%%%%%%%%%%%%%%%% M3 2 CA1 %%%%%%%%%%%%%%%
savepath='L:\Susie\SummerEphysHPCEC\AnalysisOutput\HPCEC_analysis\singleunit_phaseloc\MECunits\theta\combinedcontrol\M32CA1\';
if exist(savepath)==0
     mkdir(savepath);
end
% r inh   
data = {i_M3r2CA1_c, i_M3r2CA1_3wp, i_M3r2CA1_8wp}; %data use for plot and stats
title_name = 'r Value of M3 Inh to CA1 Theta';
[results] = scatterBars_r_SF(data, {'Control', '3wp', '8wp'}, {'blue', 'm','red'}, title_name, savepath);
titlelist_r(17,1) = {convertCharsToStrings(title_name)};
pvallist_r(17,1) = results(1,6); %control vs 3wp
pvallist_r(17,2) = results(2,6); %control vs 8wp
pvallist_r(17,3) = results(3,6); %3wp vs 8wp
% r exc
data = {e_M3r2CA1_c, e_M3r2CA1_3wp, e_M3r2CA1_8wp}; %data use for plot and stats
title_name = 'r Value of M3 Exc to CA1 Theta';
[results] = scatterBars_r_SF(data, {'Control', '3wp', '8wp'}, {'blue', 'm','red'}, title_name, savepath);
titlelist_r(18,1) = {convertCharsToStrings(title_name)};
pvallist_r(18,1) = results(1,6); %control vs 3wp
pvallist_r(18,2) = results(2,6); %control vs 8wp
pvallist_r(18,3) = results(3,6); %3wp vs 8wp


%save r pval table
r_pvaltable = table(titlelist_r, pvallist_r); %write pval to a table
writetable(r_pvaltable, 'L:\Susie\SummerEphysHPCEC\AnalysisOutput\HPCEC_analysis\singleunit_phaseloc\MECunits\theta\combinedcontrol\r_pvaltable_MEC.csv','Delimiter',',') %first col: name; second col: pval for kuipertest/Mann-Whitney test; third col: pval for ktest (for centralization). forth col: Wwtest (for equal means) 

%% below are seperate plots fro each group and cell type
% %%
% %%%% MECI cell PL to MEC2 theta %%%%
% figure(100); 
% subplot(2,4,1); %plot 3wc exc
% polarscatter(e_M1mu2MEC_3wc+pi,e_M1r2MEC_3wc,40,'MarkerFaceColor','b','MarkerFaceAlpha',.5)
% title('3wc MECI Exc to MECII');
% rlim([0 0.8])
% subplot(2,4,5); %plot 3wc_inh
% polarscatter(i_M1mu2MEC_3wc+pi, i_M1r2MEC_3wc,40,'MarkerFaceColor','b','MarkerFaceAlpha',.5)  
% title('3wc MECI Inh to MECII');
% rlim([0 0.8])
% subplot(2,4,2); %plot 3wp exc
% polarscatter(e_M1mu2MEC_3wp+pi,e_M1r2MEC_3wp,40,'MarkerFaceColor','r','MarkerFaceAlpha',.5)
% title('3wp MECI Exc to MECII');
% rlim([0 0.8])
% subplot(2,4,6); %plot 3wp inh
% polarscatter(i_M1mu2MEC_3wp+pi,i_M1r2MEC_3wp,40,'MarkerFaceColor','r','MarkerFaceAlpha',.5)
% title('3wp MECI Inh to MECII');
% rlim([0 0.8])
% subplot(2,4,3); %plot 8wc exc
% polarscatter(e_M1mu2MEC_8wc+pi,e_M1r2MEC_8wc,40,'MarkerFaceColor','b','MarkerFaceAlpha',.5)
% title('8wc MECI Exc to MECII');
% rlim([0 0.8])
% subplot(2,4,7); %plot 8wc inh
% polarscatter(i_M1mu2MEC_8wc+pi,i_M1r2MEC_8wc,40,'MarkerFaceColor','b','MarkerFaceAlpha',.5)
% title('8wc MECI Inh to MECII');
% rlim([0 0.8])
% subplot(2,4,4); %plot 8wp exc
% polarscatter(e_M1mu2MEC_8wp+pi,e_M1r2MEC_8wp,40,'MarkerFaceColor','r','MarkerFaceAlpha',.5)
% title('8wp MECI Exc to MECII');
% rlim([0 0.8])
% subplot(2,4,8); %plot 8wp inh
% polarscatter(i_M1mu2MEC_8wp+pi,i_M1r2MEC_8wp,40,'MarkerFaceColor','r','MarkerFaceAlpha',.5)
% title('8wp MECI Inh to MECII');
% rlim([0 0.8])
% %%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% 
% 
% 
% 
% %%%% MECII cell PL to MEC2 theta %%%%
% 
% figure(101); 
% subplot(2,4,1); %plot 3wc exc
% polarscatter(e_M2mu2MEC_3wc+pi,e_M2r2MEC_3wc,40,'MarkerFaceColor','b','MarkerFaceAlpha',.5)
% title('3wc MECII Exc to MECII Theta');
% rlim([0 0.6])
% subplot(2,4,5); %plot 3wc_inh
% polarscatter(i_M2mu2MEC_3wc+pi, i_M2r2MEC_3wc,40,'MarkerFaceColor','b','MarkerFaceAlpha',.5)  
% title('3wc MECII Inh to MECII Theta');
% rlim([0 0.6])
% subplot(2,4,2); %plot 3wp exc
% polarscatter(e_M2mu2MEC_3wp+pi,e_M2r2MEC_3wp,40,'MarkerFaceColor','r','MarkerFaceAlpha',.5)
% title('3wp MECII Exc to MECII Theta');
% rlim([0 0.6])
% subplot(2,4,6); %plot 3wp inh
% polarscatter(i_M2mu2MEC_3wp+pi,i_M2r2MEC_3wp,40,'MarkerFaceColor','r','MarkerFaceAlpha',.5)
% title('3wp MECII Inh to MECII Theta');
% rlim([0 0.6])
% subplot(2,4,3); %plot 8wc exc
% polarscatter(e_M2mu2MEC_8wc+pi,e_M2r2MEC_8wc,40,'MarkerFaceColor','b','MarkerFaceAlpha',.5)
% title('8wc MECII Exc to MECII Theta');
% rlim([0 0.6])
% subplot(2,4,7); %plot 8wc inh
% polarscatter(i_M2mu2MEC_8wc+pi,i_M2r2MEC_8wc,40,'MarkerFaceColor','b','MarkerFaceAlpha',.5)
% title('8wc MECII Inh to MECII Theta');
% rlim([0 0.6])
% subplot(2,4,4); %plot 8wp exc
% polarscatter(e_M2mu2MEC_8wp+pi,e_M2r2MEC_8wp,40,'MarkerFaceColor','r','MarkerFaceAlpha',.5)
% title('8wp MECII Exc to MECII Theta');
% rlim([0 0.6])
% subplot(2,4,8); %plot 8wp inh
% polarscatter(i_M2mu2MEC_8wp+pi,i_M2r2MEC_8wp,40,'MarkerFaceColor','r','MarkerFaceAlpha',.5)
% title('8wp MECII Inh to MECII Theta');
% rlim([0 0.6])
% 
% %%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% 
% 
% 
% %%%% MECIII cell PL to MECII theta %%%%
% 
% figure(102); 
% subplot(2,4,1); %plot 3wc exc
% polarscatter(e_M3mu2MEC_3wc+pi,e_M3r2MEC_3wc,40,'MarkerFaceColor','b','MarkerFaceAlpha',.5)
% title('3wc MECIII Exc to MECII Theta');
% rlim([0 0.6])
% subplot(2,4,5); %plot 3wc_inh
% polarscatter(i_M3mu2MEC_3wc+pi, i_M3r2MEC_3wc,40,'MarkerFaceColor','b','MarkerFaceAlpha',.5)  
% title('3wc MECIII Inh to MECII Theta');
% rlim([0 0.6])
% subplot(2,4,2); %plot 3wp exc
% polarscatter(e_M3mu2MEC_3wp+pi,e_M3r2MEC_3wp,40,'MarkerFaceColor','r','MarkerFaceAlpha',.5)
% title('3wp MECIII Exc to MECII Theta');
% rlim([0 0.6])
% subplot(2,4,6); %plot 3wp inh
% polarscatter(i_M3mu2MEC_3wp+pi,i_M3r2MEC_3wp,40,'MarkerFaceColor','r','MarkerFaceAlpha',.5)
% title('3wp MECIII Inh to MECII Theta');
% rlim([0 0.6])
% subplot(2,4,3); %plot 8wc exc
% polarscatter(e_M3mu2MEC_8wc+pi,e_M3r2MEC_8wc,40,'MarkerFaceColor','b','MarkerFaceAlpha',.5)
% title('8wc MECIII Exc to MECII Theta');
% rlim([0 0.6])
% subplot(2,4,7); %plot 8wc inh
% polarscatter(i_M3mu2MEC_8wc+pi,i_M3r2MEC_8wc,40,'MarkerFaceColor','b','MarkerFaceAlpha',.5)
% title('8wc MECIII Inh to MECII Theta');
% rlim([0 0.6])
% subplot(2,4,4); %plot 8wp exc
% polarscatter(e_M3mu2MEC_8wp+pi,e_M3r2MEC_8wp,40,'MarkerFaceColor','r','MarkerFaceAlpha',.5)
% title('8wp MECIII Exc to MECII Theta');
% rlim([0 0.6])
% subplot(2,4,8); %plot 8wp inh
% polarscatter(i_M3mu2MEC_8wp+pi,i_M3r2MEC_8wp,40,'MarkerFaceColor','r','MarkerFaceAlpha',.5)
% title('8wp MECIII Inh to MECII Theta');
% rlim([0 0.6])
% 
% %%%% MECI cell PL to CA1 theta %%%%
% figure(103); 
% subplot(2,4,1); %plot 3wc exc
% polarscatter(e_M1mu2CA1_3wc+pi,e_M1r2CA1_3wc,40,'MarkerFaceColor','b','MarkerFaceAlpha',.5)
% title('3wc MECI Exc to CA1 Theta');
% rlim([0 0.8])
% subplot(2,4,5); %plot 3wc_inh
% polarscatter(i_M1mu2CA1_3wc+pi, i_M1r2CA1_3wc,40,'MarkerFaceColor','b','MarkerFaceAlpha',.5)  
% title('3wc MECI Inh to CA1 Theta');
% rlim([0 0.8])
% subplot(2,4,2); %plot 3wp exc
% polarscatter(e_M1mu2CA1_3wp+pi,e_M1r2CA1_3wp,40,'MarkerFaceColor','r','MarkerFaceAlpha',.5)
% title('3wp MECI Exc to CA1 Theta');
% rlim([0 0.8])
% subplot(2,4,6); %plot 3wp inh
% polarscatter(i_M1mu2CA1_3wp+pi,i_M1r2CA1_3wp,40,'MarkerFaceColor','r','MarkerFaceAlpha',.5)
% title('3wp MECI Inh to CA1 Theta');
% rlim([0 0.8])
% subplot(2,4,3); %plot 8wc exc
% polarscatter(e_M1mu2CA1_8wc+pi,e_M1r2CA1_8wc,40,'MarkerFaceColor','b','MarkerFaceAlpha',.5)
% title('8wc MECI Exc to CA1 Theta');
% rlim([0 0.8])
% subplot(2,4,7); %plot 8wc inh
% polarscatter(i_M1mu2CA1_8wc+pi,i_M1r2CA1_8wc,40,'MarkerFaceColor','b','MarkerFaceAlpha',.5)
% title('8wc MECI Inh to CA1 Theta');
% rlim([0 0.8])
% subplot(2,4,4); %plot 8wp exc
% polarscatter(e_M1mu2CA1_8wp+pi,e_M1r2CA1_8wp,40,'MarkerFaceColor','r','MarkerFaceAlpha',.5)
% title('8wp MECI Exc to CA1 Theta');
% rlim([0 0.8])
% subplot(2,4,8); %plot 8wp inh
% polarscatter(i_M1mu2CA1_8wp+pi,i_M1r2CA1_8wp,40,'MarkerFaceColor','r','MarkerFaceAlpha',.5)
% title('8wp MECI Inh to CA1 Theta');
% rlim([0 0.8])
% 
% %%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% 
% 
% 
% %%%% MECII cell PL to CA1 theta %%%%
% 
% figure(104); 
% subplot(2,4,1); %plot 3wc exc
% polarscatter(e_M2mu2CA1_3wc+pi,e_M2r2CA1_3wc,40,'MarkerFaceColor','b','MarkerFaceAlpha',.5)
% title('3wc MECII Exc to CA1 Theta');
% rlim([0 0.6])
% subplot(2,4,5); %plot 3wc_inh
% polarscatter(i_M2mu2CA1_3wc+pi, i_M2r2CA1_3wc,40,'MarkerFaceColor','b','MarkerFaceAlpha',.5)  
% title('3wc MECII Inh to CA1 Theta');
% rlim([0 0.6])
% subplot(2,4,2); %plot 3wp exc
% polarscatter(e_M2mu2CA1_3wp+pi,e_M2r2CA1_3wp,40,'MarkerFaceColor','r','MarkerFaceAlpha',.5)
% title('3wp MECII Exc to CA1 Theta');
% rlim([0 0.6])
% subplot(2,4,6); %plot 3wp inh
% polarscatter(i_M2mu2CA1_3wp+pi,i_M2r2CA1_3wp,40,'MarkerFaceColor','r','MarkerFaceAlpha',.5)
% title('3wp MECII Inh to CA1 Theta');
% rlim([0 0.6])
% subplot(2,4,3); %plot 8wc exc
% polarscatter(e_M2mu2CA1_8wc+pi,e_M2r2CA1_8wc,40,'MarkerFaceColor','b','MarkerFaceAlpha',.5)
% title('8wc MECII Exc to CA1 Theta');
% rlim([0 0.6])
% subplot(2,4,7); %plot 8wc inh
% polarscatter(i_M2mu2CA1_8wc+pi,i_M2r2CA1_8wc,40,'MarkerFaceColor','b','MarkerFaceAlpha',.5)
% title('8wc MECII Inh to CA1 Theta');
% rlim([0 0.6])
% subplot(2,4,4); %plot 8wp exc
% polarscatter(e_M2mu2CA1_8wp+pi,e_M2r2CA1_8wp,40,'MarkerFaceColor','r','MarkerFaceAlpha',.5)
% title('8wp MECII Exc to CA1 Theta');
% rlim([0 0.6])
% subplot(2,4,8); %plot 8wp inh
% polarscatter(i_M2mu2CA1_8wp+pi,i_M2r2CA1_8wp,40,'MarkerFaceColor','r','MarkerFaceAlpha',.5)
% title('8wp MECII Inh to CA1 Theta');
% rlim([0 0.6])
% 
% 
% 
% %%%% MECIII cell PL to CA1 theta %%%%
% 
% figure(104); 
% subplot(2,4,1); %plot 3wc exc
% polarscatter(e_M3mu2CA1_3wc+pi,e_M3r2CA1_3wc,40,'MarkerFaceColor','b','MarkerFaceAlpha',.5)
% title('3wc MECIII Exc to CA1 Theta');
% rlim([0 0.6])
% subplot(2,4,5); %plot 3wc_inh
% polarscatter(i_M3mu2CA1_3wc+pi, i_M3r2CA1_3wc,40,'MarkerFaceColor','b','MarkerFaceAlpha',.5)  
% title('3wc MECIII Inh to CA1 Theta');
% rlim([0 0.6])
% subplot(2,4,2); %plot 3wp exc
% polarscatter(e_M3mu2CA1_3wp+pi,e_M3r2CA1_3wp,40,'MarkerFaceColor','r','MarkerFaceAlpha',.5)
% title('3wp MECIII Exc to CA1 Theta');
% rlim([0 0.6])
% subplot(2,4,6); %plot 3wp inh
% polarscatter(i_M3mu2CA1_3wp+pi,i_M3r2CA1_3wp,40,'MarkerFaceColor','r','MarkerFaceAlpha',.5)
% title('3wp MECIII Inh to CA1 Theta');
% rlim([0 0.6])
% subplot(2,4,3); %plot 8wc exc
% polarscatter(e_M3mu2CA1_8wc+pi,e_M3r2CA1_8wc,40,'MarkerFaceColor','b','MarkerFaceAlpha',.5)
% title('8wc MECIII Exc to CA1 Theta');
% rlim([0 0.6])
% subplot(2,4,7); %plot 8wc inh
% polarscatter(i_M3mu2CA1_8wc+pi,i_M3r2CA1_8wc,40,'MarkerFaceColor','b','MarkerFaceAlpha',.5)
% title('8wc MECIII Inh to CA1 Theta');
% rlim([0 0.6])
% subplot(2,4,4); %plot 8wp exc
% polarscatter(e_M3mu2CA1_8wp+pi,e_M3r2CA1_8wp,40,'MarkerFaceColor','r','MarkerFaceAlpha',.5)
% title('8wp MECIII Exc to CA1 Theta');
% rlim([0 0.6])
% subplot(2,4,8); %plot 8wp inh
% polarscatter(i_M3mu2CA1_8wp+pi,i_M3r2CA1_8wp,40,'MarkerFaceColor','r','MarkerFaceAlpha',.5)
% title('8wp MECIII Inh to CA1 Theta');
% rlim([0 0.6])
% %%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% 
% 
% % 
% % xaxis = categorical({'WT','AD'});
% % xaxis = reordercats(xaxis,{'WT','AD'});
% % yaxis = [mean(WTeM2FR) mean(ADeM2FR)]
% % bar(xaxis, yaxis)
% 
%  
% %end;
%  
% 
% 


